import{a as r}from"../../../_app/immutable/chunks/index-48511d2a.js";import{getPreviewFromContent as a}from"link-preview-js";import"http";import"https";import"follow-redirects";import"url";import"zlib";import"form-data";async function s(t){if(t==null)return null;!t.toLowerCase().startsWith("https://")&&!t.toLowerCase().startsWith("http://")&&(t="https://"+t);let i={url:t,icon:"/images/xp/icons/ApplicationWindow.png",name:"Untitled Program",desc:""};try{let n=await r.get(t);if(n.url=n.config.url,n.headers["x-frame-options"]!=null)return null;let e=await a(n);o(e.siteName)?o(e.title)||(i.name=e.title):i.name=e.siteName,e.favicons!=null&&e.favicons.length>=1&&(i.icon=e.favicons[e.favicons.length-1]),i.desc=e.description||""}catch{}return i}function o(t){return t==null||t.trim()==""}async function d({request:t}){let i=t.headers.get("webapp_url");console.log(i);let n=await s(i);return{status:200,body:{webapp:n}}}export{d as GET};
