import{c as j,v as d,e as i,j as a,f as U}from"../../../../_app/immutable/chunks/index-ff400fad.js";import{W as T}from"../../../../_app/immutable/chunks/Window-e98aeb2f.js";import{B as c}from"../../../../_app/immutable/chunks/Button-c9221fbd.js";import{r as O}from"../../../../_app/immutable/chunks/store-3e4ea696.js";import"../../../../_app/immutable/chunks/TitleBar-7840ae1a.js";import"lodash";import"idb-keyval";/* empty css                                                                             */import"../../../../_app/immutable/chunks/index-2945f287.js";import"../../../../_app/immutable/chunks/system-eda41220.js";const I=j((r,s,l,N)=>{let{id:b}=s,{window:f}=s,{self:x}=s,{exec_path:v}=s,u=[],h=!0,p=null,m=!1,n=null,t={title:"",youtubeUrl:"",channel:"Portfolio Channel",description:"",duration:"",views:"0 views",thumbnailUrl:"",isPublic:!0,displayOrder:0};async function y(){h=!0,p=null;try{const o=await(await fetch("/api/admin/videos")).json();o.success?u=o.videos:p=o.error||"Failed to load videos"}catch{p="Failed to connect to server"}h=!1}function F(){t={title:"",youtubeUrl:"",channel:"Portfolio Channel",description:"",duration:"",views:"0 views",thumbnailUrl:"",isPublic:!0,displayOrder:0},n=null}function k(){F(),m=!0}function C(e){n=e,t={title:e.title,youtubeUrl:`https://youtube.com/watch?v=${e.youtube_id}`,channel:e.channel,description:e.description||"",duration:e.duration||"",views:e.views||"0 views",thumbnailUrl:e.thumbnail_url||"",isPublic:e.is_public,displayOrder:e.display_order||0},m=!0}function A(){m=!1,F()}async function P(){if(!t.title||!t.youtubeUrl){alert("Title and YouTube URL are required");return}try{const e=n?"PUT":"POST",o=n?{...t,id:n.id}:t,B=await(await fetch("/api/admin/videos",{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();B.success?(await y(),A()):alert(B.error||"Failed to save video")}catch{alert("Failed to save video")}}async function V(e){if(!!confirm(`Are you sure you want to delete "${e.title}"?`))try{const _=await(await fetch("/api/admin/videos",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})})).json();_.success?await y():alert(_.error||"Failed to delete video")}catch{alert("Failed to delete video")}}function $(){O.update(e=>e.filter(o=>o!=x)),x.$destroy()}let E={width:document.querySelector("#work-space")?.offsetWidth||800,height:document.querySelector("#work-space")?.offsetHeight||600},{options:w={title:"Video Manager - Admin Panel",min_width:600,min_height:400,width:Math.min(E.width-40,900),height:Math.min(E.height-40,600),icon:"/images/xp/icons/InternetExplorer6.png",id:b,exec_path:v}}=s;s.id===void 0&&l.id&&b!==void 0&&l.id(b),s.window===void 0&&l.window&&f!==void 0&&l.window(f),s.self===void 0&&l.self&&x!==void 0&&l.self(x),s.exec_path===void 0&&l.exec_path&&v!==void 0&&l.exec_path(v),s.destroy===void 0&&l.destroy&&$!==void 0&&l.destroy($),s.options===void 0&&l.options&&w!==void 0&&l.options(w);let g,D;do g=!0,D=`${d(T,"Window").$$render(r,{options:w,on_click_close:$,this:f},{this:e=>{f=e,g=!1}},{content:()=>`<div slot="content" class="absolute inset-1 top-0 flex flex-col bg-[#ECE9D8] overflow-hidden"><div class="p-3 border-b border-[#ACA899] bg-gradient-to-b from-[#FAFAFA] to-[#ECE9D8] flex justify-between items-center"><h2 class="text-sm font-bold text-[#003399]">Manage Portfolio Videos</h2>
            ${d(c,"Button").$$render(r,{on_click:k},{},{default:()=>'<span class="px-2">Add New Video</span>'})}</div>

        ${m?`<div class="absolute inset-0 bg-black/30 flex items-center justify-center z-50"><div class="bg-[#ECE9D8] border-2 border-[#0054E3] shadow-lg w-[500px] max-h-[90%] overflow-auto"><div class="bg-gradient-to-r from-[#0054E3] to-[#2E8AEF] text-white px-3 py-2 font-bold text-sm">${i(n?"Edit Video":"Add New Video")}</div>
                    <div class="p-4 space-y-3"><div><label class="block text-xs font-medium mb-1">Title *</label>
                            <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="Video title"${a("value",t.title,0)}></div>
                        <div><label class="block text-xs font-medium mb-1">YouTube URL *</label>
                            <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="https://youtube.com/watch?v=..."${a("value",t.youtubeUrl,0)}></div>
                        <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs font-medium mb-1">Channel Name</label>
                                <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="Portfolio Channel"${a("value",t.channel,0)}></div>
                            <div><label class="block text-xs font-medium mb-1">Duration</label>
                                <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="3:45"${a("value",t.duration,0)}></div></div>
                        <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs font-medium mb-1">Views Text</label>
                                <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="1.2K views"${a("value",t.views,0)}></div>
                            <div><label class="block text-xs font-medium mb-1">Display Order</label>
                                <input type="number" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="0"${a("value",t.displayOrder,0)}></div></div>
                        <div><label class="block text-xs font-medium mb-1">Description</label>
                            <textarea class="w-full border border-[#7F9DB9] px-2 py-1 text-sm h-16 resize-none" placeholder="Video description...">${t.description||""}</textarea></div>
                        <div><label class="block text-xs font-medium mb-1">Custom Thumbnail URL (optional)</label>
                            <input type="text" class="w-full border border-[#7F9DB9] px-2 py-1 text-sm" placeholder="Leave empty to use YouTube thumbnail"${a("value",t.thumbnailUrl,0)}></div>
                        <div class="flex items-center gap-2"><input type="checkbox" id="isPublic"${a("checked",t.isPublic,1)}>
                            <label for="isPublic" class="text-xs">Visible to visitors</label></div>
                        <div class="flex justify-end gap-2 pt-2 border-t border-[#ACA899]">${d(c,"Button").$$render(r,{on_click:A},{},{default:()=>'<span class="px-3">Cancel</span>'})}
                            ${d(c,"Button").$$render(r,{on_click:P},{},{default:()=>`<span class="px-3">${i(n?"Update":"Add")} Video</span>`})}</div></div></div></div>`:""}

        <div class="flex-1 overflow-auto p-3">${h?'<div class="flex items-center justify-center h-full"><span class="text-sm text-gray-600">Loading videos...</span></div>':`${p?`<div class="flex flex-col items-center justify-center h-full gap-2"><span class="text-sm text-red-600">${i(p)}</span>
                    ${d(c,"Button").$$render(r,{on_click:y},{},{default:()=>'<span class="px-2">Retry</span>'})}</div>`:`${u.length===0?`<div class="flex flex-col items-center justify-center h-full gap-2"><span class="text-sm text-gray-600">No videos yet. Add your first video!</span>
                    ${d(c,"Button").$$render(r,{on_click:k},{},{default:()=>'<span class="px-2">Add Video</span>'})}</div>`:`<div class="space-y-2">${U(u,e=>`<div class="bg-white border border-[#ACA899] p-3 flex gap-3 items-start"><img${a("src",e.thumbnail_url||`https://img.youtube.com/vi/${e.youtube_id}/mqdefault.jpg`,0)}${a("alt",e.title,0)} class="w-32 h-20 object-cover bg-gray-200">
                            <div class="flex-1 min-w-0"><h3 class="font-medium text-sm truncate">${i(e.title)}</h3>
                                <p class="text-xs text-gray-600">${i(e.channel)}</p>
                                <p class="text-xs text-gray-500">${i(e.views)} \u2022 ${i(e.duration||"No duration")}</p>
                                <div class="flex items-center gap-2 mt-1"><span class="${"text-xs px-1.5 py-0.5 rounded "+i(e.is_public?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600",!0)}">${i(e.is_public?"Public":"Hidden")}</span>
                                    <span class="text-xs text-gray-400">Order: ${i(e.display_order||0)}</span>
                                </div></div>
                            <div class="flex flex-col gap-1">${d(c,"Button").$$render(r,{on_click:()=>C(e)},{},{default:()=>`<span class="px-2 text-xs">Edit</span>
                                `})}
                                ${d(c,"Button").$$render(r,{on_click:()=>V(e)},{},{default:()=>`<span class="px-2 text-xs">Delete</span>
                                `})}</div>
                        </div>`)}</div>`}`}`}</div>

        <div class="p-2 border-t border-[#ACA899] bg-[#ECE9D8] text-xs text-gray-600">${i(u.length)} video${i(u.length!==1?"s":"")} in your portfolio
        </div></div>`})}

`;while(!g);return D});export{I as default};
