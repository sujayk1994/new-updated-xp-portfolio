import{S as X,i as Z,s as Y,l as u,m as _,n as w,h as c,p as m,q as D,b as y,E as k,P as $,V as ee,o as se,a9 as j,a as S,e as E,c as C,J as h,N as P,r as ie,u as ne}from"../../chunks/index-59da92c8.js";import{b as ae,o as oe}from"../../chunks/utils-1f7a3290.js";import{g as F,s as N}from"../../chunks/index-355ed6be.js";import{a as V}from"../../chunks/index-5725e307.js";import{h as pe,w as I,f as te,c as ge}from"../../chunks/store-fabc0359.js";import{S as W,b as R,j as B,g as G}from"../../chunks/system-e72d84b7.js";import"../../chunks/_commonjsHelpers-cea7ac1a.js";import"../../chunks/index-5377a032.js";function le(r){let e,i,n,s,a,o=r[0]?.showLogo!==!1&&A(),l=r[0]?.showProgress!==!1&&L(),t=r[0]?.showCopyright!==!1&&T(),f=r[0]?.showLogo!==!1&&z();return{c(){e=u("div"),o&&o.c(),i=S(),l&&l.c(),n=S(),t&&t.c(),s=S(),f&&f.c(),a=E(),this.h()},l(g){e=_(g,"DIV",{class:!0});var d=w(e);o&&o.l(d),i=C(d),l&&l.l(d),d.forEach(c),n=C(g),t&&t.l(g),s=C(g),f&&f.l(g),a=E(),this.h()},h(){m(e,"class","absolute top-[50%] -translate-y-[50%] left-[50%] -translate-x-[50%] animate-fadein")},m(g,d){y(g,e,d),o&&o.m(e,null),h(e,i),l&&l.m(e,null),y(g,n,d),t&&t.m(g,d),y(g,s,d),f&&f.m(g,d),y(g,a,d)},p(g,d){g[0]?.showLogo!==!1?o||(o=A(),o.c(),o.m(e,i)):o&&(o.d(1),o=null),g[0]?.showProgress!==!1?l||(l=L(),l.c(),l.m(e,null)):l&&(l.d(1),l=null),g[0]?.showCopyright!==!1?t||(t=T(),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null),g[0]?.showLogo!==!1?f||(f=z(),f.c(),f.m(a.parentNode,a)):f&&(f.d(1),f=null)},d(g){g&&c(e),o&&o.d(),l&&l.d(),g&&c(n),t&&t.d(g),g&&c(s),f&&f.d(g),g&&c(a)}}}function re(r){let e,i,n;return{c(){e=u("div"),i=u("img"),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=w(e);i=_(a,"IMG",{src:!0,alt:!0,class:!0}),a.forEach(c),this.h()},h(){P(i.src,n=r[0].customGif)||m(i,"src",n),m(i,"alt","Loading"),m(i,"class","max-w-full max-h-full object-contain"),m(e,"class","absolute inset-0 flex items-center justify-center animate-fadein")},m(s,a){y(s,e,a),h(e,i)},p(s,a){a&1&&!P(i.src,n=s[0].customGif)&&m(i,"src",n)},d(s){s&&c(e)}}}function ce(r){return{c:k,l:k,m:k,p:k,d:k}}function A(r){let e,i;return{c(){e=u("img"),this.h()},l(n){e=_(n,"IMG",{src:!0,alt:!0,width:!0}),this.h()},h(){P(e.src,i="/images/xp_loading_logo.jpg")||m(e,"src",i),m(e,"alt",""),m(e,"width","400px")},m(n,s){y(n,e,s)},d(n){n&&c(e)}}}function L(r){let e,i,n,s,a,o;return{c(){e=u("div"),i=u("div"),n=S(),s=u("div"),a=S(),o=u("div"),this.h()},l(l){e=_(l,"DIV",{class:!0});var t=w(e);i=_(t,"DIV",{class:!0}),w(i).forEach(c),n=C(t),s=_(t,"DIV",{class:!0}),w(s).forEach(c),a=C(t),o=_(t,"DIV",{class:!0}),w(o).forEach(c),t.forEach(c),this.h()},h(){m(i,"class","svelte-1ccx1ah"),m(s,"class","svelte-1ccx1ah"),m(o,"class","svelte-1ccx1ah"),m(e,"class","xp-loader svelte-1ccx1ah")},m(l,t){y(l,e,t),h(e,i),h(e,n),h(e,s),h(e,a),h(e,o)},d(l){l&&c(e)}}}function T(r){let e,i,n;return{c(){e=u("div"),i=u("p"),n=ie("Copyright \xA9 Microsoft Corporation"),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=w(e);i=_(a,"P",{});var o=w(i);n=ne(o,"Copyright \xA9 Microsoft Corporation"),o.forEach(c),a.forEach(c),this.h()},h(){m(e,"class","absolute left-8 bottom-8 animate-fadein text-base font-sans")},m(s,a){y(s,e,a),h(e,i),h(i,n)},d(s){s&&c(e)}}}function z(r){let e,i,n;return{c(){e=u("div"),i=u("img"),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=w(e);i=_(a,"IMG",{src:!0,width:!0,alt:!0}),a.forEach(c),this.h()},h(){P(i.src,n="/images/xp_loading_mslogo.jpg")||m(i,"src",n),m(i,"width","120px"),m(i,"alt",""),m(e,"class","absolute right-8 bottom-8 animate-fadein")},m(s,a){y(s,e,a),h(e,i)},d(s){s&&c(e)}}}function me(r){let e;function i(a,o){return a[1]?a[0]?.type==="custom"&&a[0]?.customGif?re:le:ce}let n=i(r),s=n(r);return{c(){e=u("div"),s.c(),this.h()},l(a){e=_(a,"DIV",{class:!0,style:!0});var o=w(e);s.l(o),o.forEach(c),this.h()},h(){m(e,"class","absolute inset-0 overflow-hidden text-slate-100"),D(e,"background-color",r[0]?.backgroundColor||"#000000")},m(a,o){y(a,e,o),s.m(e,null)},p(a,[o]){n===(n=i(a))&&s?s.p(a,o):(s.d(1),s=n(a),s&&(s.c(),s.m(e,null))),o&1&&D(e,"background-color",a[0]?.backgroundColor||"#000000")},i:k,o:k,d(a){a&&c(e),s.d()}}}function fe(r){return new Promise((e,i)=>{const n=new Image;n.onload=()=>e(n),n.onerror=()=>e(null),n.src=r})}function de(){let r=["/html/jspaint/index.html","/html/notepad/index.html"],e=document.querySelector("#iframe-preload");for(let i of r){let n=document.createElement("iframe");n.style.position="absolute",n.style.inset="0",n.src=i,n.onload=s=>{console.log("loaded ",i),s.target.remove()},e.appendChild(n)}}function xe(r,e,i){let n;$(r,I,p=>i(3,n=p));let s=ee(),a=!1,o=null,l=!1,t=["/files/blue_hill.jpg","/files/new_stories.mp3","/files/sunset.jpg","/files/symphony_9.mp3","/files/wallpapers/Ascent.jpg","/files/wallpapers/Autumn.jpg","/files/wallpapers/Azul.jpg","/files/wallpapers/Bliss.jpg","/files/wallpapers/Follow.jpg","/files/wallpapers/Friend.jpg","/files/wallpapers/Moonflower.jpg","/files/wallpapers/Radiance.jpg","/files/wallpapers/Redmoondesert.jpg","/files/wallpapers/Tulips.jpg","/files/wallpapers/Wind.jpg","/files/water_lily.jpg","/files/winter.jpg"],f=["/images/95/0.png","/images/ms.png","/images/radio_check.png","/images/xp/battery_cell.png","/images/xp/checkmark.png","/images/xp/copying.gif","/images/xp/crt_monitor.png","/images/xp/icons/876.png","/images/xp/icons/AccessibilityWizard.png","/images/xp/icons/AddressBook.png","/images/xp/icons/AdventureMiner.png","/images/xp/icons/AgeOfWar.png","/images/xp/icons/ApplicationWindow.png","/images/xp/icons/ArmyWarfare.png","/images/xp/icons/BAT.png","/images/xp/icons/BOOK.png","/images/xp/icons/Back.png","/images/xp/icons/BackupWizard.png","/images/xp/icons/BigFarm.png","/images/xp/icons/Bitmap.png","/images/xp/icons/Briefcase.png","/images/xp/icons/BubblePop.png","/images/xp/icons/CSS.png","/images/xp/icons/Calculator.png","/images/xp/icons/Charmap.png","/images/xp/icons/CommandPrompt.png","/images/xp/icons/ControlPanel.png","/images/xp/icons/CopyingConflict.png","/images/xp/icons/Critical.png","/images/xp/icons/CursedTreasure.png","/images/xp/icons/DLL.png","/images/xp/icons/DOC.png","/images/xp/icons/DayD.png","/images/xp/icons/Default.png","/images/xp/icons/DeleteConfirmation.png","/images/xp/icons/Desktop.png","/images/xp/icons/DiskCleanup.png","/images/xp/icons/DiskDefragmenter.png","/images/xp/icons/DisplayProperties.png","/images/xp/icons/DualForceIdle.png","/images/xp/icons/Email.png","/images/xp/icons/Empire.png","/images/xp/icons/Exit.png","/images/xp/icons/Explorer.png","/images/xp/icons/Favorites.png","/images/xp/icons/Fax.png","/images/xp/icons/FileandSettingsTransferWizard.png","/images/xp/icons/FlashPlayer.png","/images/xp/icons/FloppyDisk.png","/images/xp/icons/FolderClosed.png","/images/xp/icons/FolderView-Classic.png","/images/xp/icons/FolderView.png","/images/xp/icons/Font.png","/images/xp/icons/Forward.png","/images/xp/icons/FoxitReader.png","/images/xp/icons/GIF.png","/images/xp/icons/Go.png","/images/xp/icons/GrandPrix.png","/images/xp/icons/HelpandSupport.png","/images/xp/icons/HighwayRacer.png","/images/xp/icons/HyperTerminal.png","/images/xp/icons/IEHistory.png","/images/xp/icons/IEHome.png","/images/xp/icons/IERefresh.png","/images/xp/icons/IEStop.png","/images/xp/icons/Infiltrate.png","/images/xp/icons/Information.png","/images/xp/icons/InternetExplorer6.png","/images/xp/icons/InternetShortcut.png","/images/xp/icons/JPG.png","/images/xp/icons/Java.png","/images/xp/icons/JavaScript.png","/images/xp/icons/Keyboard.png","/images/xp/icons/Koodo.png","/images/xp/icons/LocalDisk.png","/images/xp/icons/Logout.png","/images/xp/icons/MPC.png","/images/xp/icons/MPC_audio.png","/images/xp/icons/MPC_video.png","/images/xp/icons/MSWord.png","/images/xp/icons/Magnifier.png","/images/xp/icons/Maximize.png","/images/xp/icons/MineCraft.png","/images/xp/icons/Minesweeper.png","/images/xp/icons/Minimize.png","/images/xp/icons/Mute.png","/images/xp/icons/MyComputer.png","/images/xp/icons/MyMusic.png","/images/xp/icons/MyNetworkPlaces.png","/images/xp/icons/MyPictures.png","/images/xp/icons/Narrator.png","/images/xp/icons/NetworkConnection.png","/images/xp/icons/NetworkConnections.png","/images/xp/icons/NetworkSetup.png","/images/xp/icons/NewFolder.png","/images/xp/icons/NewNetworkConnection.png","/images/xp/icons/Notepad.png","/images/xp/icons/On-ScreenKeyboard.png","/images/xp/icons/PDF.png","/images/xp/icons/Paint.png","/images/xp/icons/Photon.png","/images/xp/icons/Power.png","/images/xp/icons/Programs.png","/images/xp/icons/Properties.png","/images/xp/icons/Publishtoweb.png","/images/xp/icons/Python.png","/images/xp/icons/RAR.png","/images/xp/icons/RTF.png","/images/xp/icons/RecycleBinempty.png","/images/xp/icons/RecycleBinfull.png","/images/xp/icons/RemoteDesktop.png","/images/xp/icons/RemovableMedia.png","/images/xp/icons/Restart.png","/images/xp/icons/Restore.png","/images/xp/icons/Run.png","/images/xp/icons/SUB.png","/images/xp/icons/SWF.png","/images/xp/icons/SantaParkour.png","/images/xp/icons/ScheduledTasks.png","/images/xp/icons/Search.png","/images/xp/icons/SecurityCenter.png","/images/xp/icons/SecurityError.png","/images/xp/icons/Setup.png","/images/xp/icons/SharedFolder.png","/images/xp/icons/Shortcutoverlay.png","/images/xp/icons/Skydom.png","/images/xp/icons/Solitaire.png","/images/xp/icons/SpaceBattle.png","/images/xp/icons/Standby.png","/images/xp/icons/StartMenuPrograms.png","/images/xp/icons/StartMenuProgramsAlt.png","/images/xp/icons/StickWar.png","/images/xp/icons/Stop.png","/images/xp/icons/Synchronize.png","/images/xp/icons/SystemInformation.png","/images/xp/icons/SystemRestore.png","/images/xp/icons/TIFF.png","/images/xp/icons/TXT.png","/images/xp/icons/TeacherSimulator.png","/images/xp/icons/TourXP.png","/images/xp/icons/TrainMaster.png","/images/xp/icons/URL.png","/images/xp/icons/Up.png","/images/xp/icons/VBS.png","/images/xp/icons/Volume.png","/images/xp/icons/VolumeLevel.png","/images/xp/icons/Vortecspace.jpg","/images/xp/icons/WMV.png","/images/xp/icons/WindowsCatalog.png","/images/xp/icons/WindowsMediaPlayer9.png","/images/xp/icons/WindowsMessenger.png","/images/xp/icons/WindowsPictureandFaxViewer.png","/images/xp/icons/WindowsUpdate.png","/images/xp/icons/WirelessNetworkSetup.png","/images/xp/icons/Wizard.png","/images/xp/icons/Wordpad.png","/images/xp/icons/XML.png","/images/xp/icons/Zipfolder.png","/images/xp/icons/explorerproperties.png","/images/xp/icons/tile_close.png","/images/xp/icons/tile_maximize.png","/images/xp/icons/tile_minimize.png","/images/xp/icons/tile_restore.png","/images/xp/radio_check.png","/images/xp/start_btn_normal.png","/images/xp/tile_close.png","/images/xp_loading_logo.jpg","/images/xp_loading_mslogo.jpg","/images/xp_logo.png","/images/xp_logo_horizontal.png"],g=["/audio/xp_installing.mp3","/audio/xp_shutdown.mp3","/audio/xp_startup.mp3"],d=["/fonts/levi.ttf","/fonts/ms_sans_serif.ttf","/fonts/ms_sans_serif_bold.ttf","/fonts/trebuchet.ttf"],O=["/empty/empty.png","/empty/empty.txt"];se(async()=>{await U(),await q(),await J(),load_assets([...g,...f,...t,...d,...O],()=>{a=!0});let p=0;do if(await ae(2e3),p++,p>=3)break;while(!a);de(),K(),console.log("after preload_context_menu"),oe()?s("load_page",{url:"./installation/95/installing.svelte"}):s("load_page",{url:"./xp/desktop.svelte"})});async function U(){let p=await F("hard_drive");p==null&&(p=(await V({method:"get",url:"/json/hard_drive.json"})).data,await N("hard_drive",p)),H(p),console.log(p),pe.set(p)}function H(p){let v=new Date().getTime();for(let Q of Object.keys(p)){let x=p[Q];x.children==null&&(x.children=[...x.files,...x.folders],delete x.files,delete x.folders),x.date_created==null&&(x.date_created=v),x.date_modified==null&&(x.date_modified=v),x.sort_option==null&&(x.sort_option=W.NONE),x.sort_order==null&&(x.sort_order=R.ASCENDING)}const M="nt1QdU9Sws26H26UNQZcQU",b="contactMeDesktopItem001";p[b]?p[b].icon!=="/images/xp/icons/ContactMe.webp"&&(p[b].icon="/images/xp/icons/ContactMe.webp"):(p[b]={id:b,type:"file",basename:"Contact Me",name:"Contact Me.exe",storage_type:"fake",url:"./programs/contact_me.svelte",ext:".exe",parent:M,size:5e3,executable:!0,icon:"/images/xp/icons/ContactMe.webp",children:[],date_created:v,date_modified:v,sort_option:W.NONE,sort_order:R.ASCENDING},p[M]&&!p[M].children.includes(b)&&p[M].children.push(b))}async function q(){j(I,n=await F("wallpaper"),n),n==null&&(j(I,n=B,n),await N("wallpaper",B))}async function J(){try{const p=await V.get("/api/admin/bootscreen");p.data&&p.data.settings?(i(0,o={type:p.data.settings.type||"default",customGif:p.data.settings.customGif||null,showLogo:p.data.settings.showLogo!==!1,showProgress:p.data.settings.showProgress!==!1,showCopyright:p.data.settings.showCopyright!==!1,backgroundColor:p.data.settings.backgroundColor||"#000000"}),o.type==="custom"&&o.customGif&&await fe(o.customGif)):i(0,o={...G})}catch(p){console.error("Error loading boot screen from API, using defaults:",p),i(0,o={...G})}te.set(o),i(1,l=!0)}function K(){let p=["ProgramTile","Desktop","FSVoid","FSItem","RecycleBin"];for(let v of p)ge.set({x:-1e3,y:-1e3,type:v,originator:{}})}return[o,l]}class Se extends X{constructor(e){super(),Z(this,e,xe,me,Y,{})}}export{Se as default};
