import{S as $e,i as et,X as ae,s as tt,w as lt,x as rt,y as st,O as J,f as it,t as at,B as ot,P as nt,o as ct,W as dt,l as u,a as T,m as h,n as _,c as V,h as n,p as d,b as B,J as s,_ as Re,r as D,u as M,v as $,Q as ne,R as Ze,E as be,a8 as ft,ac as ut,N as ce}from"../../../chunks/index-59da92c8.js";import{W as ht}from"../../../chunks/Window-6d40284c.js";import{r as _t}from"../../../chunks/store-fabc0359.js";import{i as pt}from"../../../chunks/admin-b2f51e94.js";import"../../../chunks/TitleBar-a503be9c.js";import"../../../chunks/utils-1f7a3290.js";import"../../../chunks/lodash-b0811ec1.js";import"../../../chunks/_commonjsHelpers-cea7ac1a.js";import"../../../chunks/index-355ed6be.js";import"../../../chunks/index-5377a032.js";import"../../../chunks/system-e72d84b7.js";const{window:mt}=dt;function We(a,e,t){const l=a.slice();return l[38]=e[t],l}function vt(a){let e,t,l,r,i,c,o,f,k,y,m=a[12]&&Ge(a);function b(v,z){return v[5].length===0?Et:kt}let U=b(a),g=U(a);return{c(){e=u("div"),t=u("div"),l=u("div"),r=u("h1"),i=D("Magazine Portfolio"),c=T(),o=u("p"),f=D("Click on a magazine to view"),k=T(),m&&m.c(),y=T(),g.c(),this.h()},l(v){e=h(v,"DIV",{class:!0});var z=_(e);t=h(z,"DIV",{class:!0});var j=_(t);l=h(j,"DIV",{});var E=_(l);r=h(E,"H1",{class:!0});var I=_(r);i=M(I,"Magazine Portfolio"),I.forEach(n),c=V(E),o=h(E,"P",{class:!0});var w=_(o);f=M(w,"Click on a magazine to view"),w.forEach(n),E.forEach(n),k=V(j),m&&m.l(j),j.forEach(n),y=V(z),g.l(z),z.forEach(n),this.h()},h(){d(r,"class","text-2xl font-bold text-white"),d(o,"class","text-gray-400 text-sm mt-1"),d(t,"class","flex justify-between items-center mb-6"),d(e,"class","flex-1 flex flex-col p-6 overflow-hidden")},m(v,z){B(v,e,z),s(e,t),s(t,l),s(l,r),s(r,i),s(l,c),s(l,o),s(o,f),s(t,k),m&&m.m(t,null),s(e,y),g.m(e,null)},p(v,z){v[12]?m?m.p(v,z):(m=Ge(v),m.c(),m.m(t,null)):m&&(m.d(1),m=null),U===(U=b(v))&&g?g.p(v,z):(g.d(1),g=U(v),g&&(g.c(),g.m(e,null)))},d(v){v&&n(e),m&&m.d(),g.d()}}}function bt(a){let e,t,l,r,i,c,o,f,k=a[4].title+"",y,m,b,U,g,v,z,j;function E(L,x){return x[0]&16&&(v=null),v==null&&(v=!!ve(L[4].embedUrl)),v?Ut:Mt}let I=E(a,[-1,-1]),w=I(a);return{c(){e=u("div"),t=u("div"),l=u("button"),r=u("span"),i=D("\u2190"),c=D(" Back to Gallery"),o=T(),f=u("h2"),y=D(k),m=T(),b=u("div"),U=T(),g=u("div"),w.c(),this.h()},l(L){e=h(L,"DIV",{class:!0});var x=_(e);t=h(x,"DIV",{class:!0});var C=_(t);l=h(C,"BUTTON",{class:!0});var A=_(l);r=h(A,"SPAN",{});var H=_(r);i=M(H,"\u2190"),H.forEach(n),c=M(A," Back to Gallery"),A.forEach(n),o=V(C),f=h(C,"H2",{class:!0});var R=_(f);y=M(R,k),R.forEach(n),m=V(C),b=h(C,"DIV",{class:!0}),_(b).forEach(n),C.forEach(n),U=V(x),g=h(x,"DIV",{class:!0});var W=_(g);w.l(W),W.forEach(n),x.forEach(n),this.h()},h(){d(l,"class","px-4 py-2 bg-white/10 text-white rounded hover:bg-white/20 flex items-center gap-2"),d(f,"class","text-white font-semibold"),d(b,"class","w-32"),d(t,"class","flex items-center justify-between p-3 bg-black/30"),d(g,"class","flex-1 relative bg-black"),d(e,"class","flex-1 flex flex-col")},m(L,x){B(L,e,x),s(e,t),s(t,l),s(l,r),s(r,i),s(l,c),s(t,o),s(t,f),s(f,y),s(t,m),s(t,b),s(e,U),s(e,g),w.m(g,null),z||(j=J(l,"click",a[14]),z=!0)},p(L,x){x[0]&16&&k!==(k=L[4].title+"")&&$(y,k),I===(I=E(L,x))&&w?w.p(L,x):(w.d(1),w=I(L),w&&(w.c(),w.m(g,null)))},d(L){L&&n(e),w.d(),z=!1,j()}}}function gt(a){let e,t,l,r=a[8].id.startsWith("new_")?"Add New Magazine":"Edit Magazine",i,c,o,f,k,y,m,b,U,g,v,z,j,E,I,w,L,x,C,A,H,R,W,de,Q,se=a[10]?"Uploading...":"Upload Cover",oe,fe,G,ee,ue,he,X,_e,te,pe,p,N,le,q,ie,Te,Ve,Z,me=a[10]?"Saving...":"Save Magazine",ge,we,xe,Ne;function Pe(P,S){return P[8].coverUrl?Vt:Tt}let ke=Pe(a),Y=ke(a),O=a[8].embedUrl&&Ke(a),F=a[11]&&Qe(a);return{c(){e=u("div"),t=u("div"),l=u("h2"),i=D(r),c=T(),o=u("div"),f=u("div"),k=u("label"),y=D("Title *"),m=T(),b=u("input"),U=T(),g=u("div"),v=u("label"),z=D("Description"),j=T(),E=u("textarea"),I=T(),w=u("div"),L=u("label"),x=D("Cover Image"),C=T(),A=u("div"),Y.c(),H=T(),R=u("div"),W=u("input"),de=T(),Q=u("button"),oe=D(se),fe=T(),G=u("div"),ee=u("label"),ue=D("FlipHTML5 Embed Code"),he=T(),X=u("textarea"),_e=T(),te=u("p"),pe=D("Paste the HTML embed code or URL from FlipHTML5"),p=T(),O&&O.c(),N=T(),F&&F.c(),le=T(),q=u("div"),ie=u("button"),Te=D("Cancel"),Ve=T(),Z=u("button"),ge=D(me),this.h()},l(P){e=h(P,"DIV",{class:!0});var S=_(e);t=h(S,"DIV",{class:!0});var Ee=_(t);l=h(Ee,"H2",{class:!0});var Le=_(l);i=M(Le,r),Le.forEach(n),c=V(Ee),o=h(Ee,"DIV",{class:!0});var K=_(o);f=h(K,"DIV",{});var ye=_(f);k=h(ye,"LABEL",{class:!0});var Ae=_(k);y=M(Ae,"Title *"),Ae.forEach(n),m=V(ye),b=h(ye,"INPUT",{type:!0,class:!0,placeholder:!0}),ye.forEach(n),U=V(K),g=h(K,"DIV",{});var ze=_(g);v=h(ze,"LABEL",{class:!0});var Ce=_(v);z=M(Ce,"Description"),Ce.forEach(n),j=V(ze),E=h(ze,"TEXTAREA",{rows:!0,class:!0,placeholder:!0}),_(E).forEach(n),ze.forEach(n),I=V(K),w=h(K,"DIV",{});var Ie=_(w);L=h(Ie,"LABEL",{class:!0});var je=_(L);x=M(je,"Cover Image"),je.forEach(n),C=V(Ie),A=h(Ie,"DIV",{class:!0});var De=_(A);Y.l(De),H=V(De),R=h(De,"DIV",{});var Me=_(R);W=h(Me,"INPUT",{type:!0,accept:!0,class:!0}),de=V(Me),Q=h(Me,"BUTTON",{class:!0});var Be=_(Q);oe=M(Be,se),Be.forEach(n),Me.forEach(n),De.forEach(n),Ie.forEach(n),fe=V(K),G=h(K,"DIV",{});var re=_(G);ee=h(re,"LABEL",{class:!0});var Se=_(ee);ue=M(Se,"FlipHTML5 Embed Code"),Se.forEach(n),he=V(re),X=h(re,"TEXTAREA",{rows:!0,class:!0,placeholder:!0}),_(X).forEach(n),_e=V(re),te=h(re,"P",{class:!0});var Oe=_(te);pe=M(Oe,"Paste the HTML embed code or URL from FlipHTML5"),Oe.forEach(n),p=V(re),O&&O.l(re),re.forEach(n),N=V(K),F&&F.l(K),le=V(K),q=h(K,"DIV",{class:!0});var Ue=_(q);ie=h(Ue,"BUTTON",{class:!0});var Fe=_(ie);Te=M(Fe,"Cancel"),Fe.forEach(n),Ve=V(Ue),Z=h(Ue,"BUTTON",{class:!0});var He=_(Z);ge=M(He,me),He.forEach(n),Ue.forEach(n),K.forEach(n),Ee.forEach(n),S.forEach(n),this.h()},h(){d(l,"class","text-xl font-bold text-white mb-4"),d(k,"class","block text-sm text-gray-300 mb-1"),d(b,"type","text"),d(b,"class","w-full px-3 py-2 bg-white/20 text-white rounded border border-white/30 focus:outline-none focus:border-purple-400"),d(b,"placeholder","Enter magazine title"),d(v,"class","block text-sm text-gray-300 mb-1"),d(E,"rows","2"),d(E,"class","w-full px-3 py-2 bg-white/20 text-white rounded border border-white/30 focus:outline-none focus:border-purple-400 resize-none"),d(E,"placeholder","Brief description"),d(L,"class","block text-sm text-gray-300 mb-1"),d(W,"type","file"),d(W,"accept","image/*"),d(W,"class","hidden"),Q.disabled=a[10],d(Q,"class","px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 text-sm"),d(A,"class","flex items-center gap-4"),d(ee,"class","block text-sm text-gray-300 mb-1"),d(X,"rows","4"),d(X,"class","w-full px-3 py-2 bg-white/20 text-white rounded border border-white/30 focus:outline-none focus:border-purple-400 resize-none font-mono text-xs"),d(X,"placeholder","Paste embed code from FlipHTML5 here..."),d(te,"class","text-xs text-gray-400 mt-1"),d(ie,"class","px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700"),Z.disabled=we=a[10]||!a[8].title,d(Z,"class","px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"),d(q,"class","flex justify-end gap-3 pt-4 border-t border-white/20"),d(o,"class","space-y-4"),d(t,"class","bg-white/10 backdrop-blur rounded-lg p-6 max-w-2xl mx-auto"),d(e,"class","flex-1 overflow-auto p-4")},m(P,S){B(P,e,S),s(e,t),s(t,l),s(l,i),s(t,c),s(t,o),s(o,f),s(f,k),s(k,y),s(f,m),s(f,b),ne(b,a[8].title),s(o,U),s(o,g),s(g,v),s(v,z),s(g,j),s(g,E),ne(E,a[8].description),s(o,I),s(o,w),s(w,L),s(L,x),s(w,C),s(w,A),Y.m(A,null),s(A,H),s(A,R),s(R,W),a[29](W),s(R,de),s(R,Q),s(Q,oe),s(o,fe),s(o,G),s(G,ee),s(ee,ue),s(G,he),s(G,X),ne(X,a[8].embedUrl),s(G,_e),s(G,te),s(te,pe),s(G,p),O&&O.m(G,null),s(o,N),F&&F.m(o,null),s(o,le),s(o,q),s(q,ie),s(ie,Te),s(q,Ve),s(q,Z),s(Z,ge),xe||(Ne=[J(b,"input",a[27]),J(E,"input",a[28]),J(W,"change",a[20]),J(Q,"click",a[30]),J(X,"input",a[31]),J(ie,"click",a[17]),J(Z,"click",a[18])],xe=!0)},p(P,S){S[0]&256&&r!==(r=P[8].id.startsWith("new_")?"Add New Magazine":"Edit Magazine")&&$(i,r),S[0]&256&&b.value!==P[8].title&&ne(b,P[8].title),S[0]&256&&ne(E,P[8].description),ke===(ke=Pe(P))&&Y?Y.p(P,S):(Y.d(1),Y=ke(P),Y&&(Y.c(),Y.m(A,H))),S[0]&1024&&se!==(se=P[10]?"Uploading...":"Upload Cover")&&$(oe,se),S[0]&1024&&(Q.disabled=P[10]),S[0]&256&&ne(X,P[8].embedUrl),P[8].embedUrl?O?O.p(P,S):(O=Ke(P),O.c(),O.m(G,null)):O&&(O.d(1),O=null),P[11]?F?F.p(P,S):(F=Qe(P),F.c(),F.m(o,le)):F&&(F.d(1),F=null),S[0]&1024&&me!==(me=P[10]?"Saving...":"Save Magazine")&&$(ge,me),S[0]&1280&&we!==(we=P[10]||!P[8].title)&&(Z.disabled=we)},d(P){P&&n(e),Y.d(),a[29](null),O&&O.d(),F&&F.d(),xe=!1,Ze(Ne)}}}function wt(a){let e,t,l;return{c(){e=u("div"),t=u("div"),l=D("Loading magazines..."),this.h()},l(r){e=h(r,"DIV",{class:!0});var i=_(e);t=h(i,"DIV",{class:!0});var c=_(t);l=M(c,"Loading magazines..."),c.forEach(n),i.forEach(n),this.h()},h(){d(t,"class","text-white text-lg"),d(e,"class","flex-1 flex items-center justify-center")},m(r,i){B(r,e,i),s(e,t),s(t,l)},p:be,d(r){r&&n(e)}}}function Ge(a){let e,t,l,r;return{c(){e=u("button"),t=D("+ Add Magazine"),this.h()},l(i){e=h(i,"BUTTON",{class:!0});var c=_(e);t=M(c,"+ Add Magazine"),c.forEach(n),this.h()},h(){d(e,"class","px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 shadow-lg")},m(i,c){B(i,e,c),s(e,t),l||(r=J(e,"click",a[15]),l=!0)},p:be,d(i){i&&n(e),l=!1,r()}}}function kt(a){let e,t,l=[],r=new Map,i=a[5];const c=o=>o[38].id;for(let o=0;o<i.length;o+=1){let f=We(a,i,o),k=c(f);r.set(k,l[o]=Xe(k,f))}return{c(){e=u("div"),t=u("div");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=h(o,"DIV",{class:!0});var f=_(e);t=h(f,"DIV",{class:!0});var k=_(t);for(let y=0;y<l.length;y+=1)l[y].l(k);k.forEach(n),f.forEach(n),this.h()},h(){d(t,"class","grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"),d(e,"class","flex-1 overflow-auto")},m(o,f){B(o,e,f),s(e,t);for(let k=0;k<l.length;k+=1)l[k].m(t,null)},p(o,f){f[0]&602144&&(i=o[5],l=ft(l,f,c,1,o,i,r,t,ut,Xe,null,We))},d(o){o&&n(e);for(let f=0;f<l.length;f+=1)l[f].d()}}}function Et(a){let e,t,l,r,i,c,o,f;function k(b,U){return b[12]?Dt:It}let y=k(a),m=y(a);return{c(){e=u("div"),t=u("div"),l=u("div"),r=D("\u{1F4DA}"),i=T(),c=u("p"),o=D("No magazines yet"),f=T(),m.c(),this.h()},l(b){e=h(b,"DIV",{class:!0});var U=_(e);t=h(U,"DIV",{class:!0});var g=_(t);l=h(g,"DIV",{class:!0});var v=_(l);r=M(v,"\u{1F4DA}"),v.forEach(n),i=V(g),c=h(g,"P",{class:!0});var z=_(c);o=M(z,"No magazines yet"),z.forEach(n),f=V(g),m.l(g),g.forEach(n),U.forEach(n),this.h()},h(){d(l,"class","text-6xl mb-4 opacity-30"),d(c,"class","text-lg mb-2"),d(t,"class","text-center text-gray-400"),d(e,"class","flex-1 flex items-center justify-center")},m(b,U){B(b,e,U),s(e,t),s(t,l),s(l,r),s(t,i),s(t,c),s(c,o),s(t,f),m.m(t,null)},p(b,U){y!==(y=k(b))&&(m.d(1),m=y(b),m&&(m.c(),m.m(t,null)))},d(b){b&&n(e),m.d()}}}function yt(a){let e,t,l;return{c(){e=u("div"),t=u("span"),l=D("\u{1F4D6}"),this.h()},l(r){e=h(r,"DIV",{class:!0});var i=_(e);t=h(i,"SPAN",{class:!0});var c=_(t);l=M(c,"\u{1F4D6}"),c.forEach(n),i.forEach(n),this.h()},h(){d(t,"class","text-4xl"),d(e,"class","w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-900 to-indigo-900")},m(r,i){B(r,e,i),s(e,t),s(t,l)},p:be,d(r){r&&n(e)}}}function zt(a){let e,t,l;return{c(){e=u("img"),this.h()},l(r){e=h(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ce(e.src,t=a[38].coverUrl)||d(e,"src",t),d(e,"alt",l=a[38].title),d(e,"class","w-full h-full object-cover")},m(r,i){B(r,e,i)},p(r,i){i[0]&32&&!ce(e.src,t=r[38].coverUrl)&&d(e,"src",t),i[0]&32&&l!==(l=r[38].title)&&d(e,"alt",l)},d(r){r&&n(e)}}}function qe(a){let e,t=a[38].description+"",l;return{c(){e=u("p"),l=D(t),this.h()},l(r){e=h(r,"P",{class:!0});var i=_(e);l=M(i,t),i.forEach(n),this.h()},h(){d(e,"class","text-gray-300 text-xs truncate mt-1")},m(r,i){B(r,e,i),s(e,l)},p(r,i){i[0]&32&&t!==(t=r[38].description+"")&&$(l,t)},d(r){r&&n(e)}}}function Je(a){let e,t,l,r,i,c,o,f;function k(...m){return a[32](a[38],...m)}function y(...m){return a[33](a[38],...m)}return{c(){e=u("div"),t=u("button"),l=D("\u270F\uFE0F"),r=T(),i=u("button"),c=D("\u{1F5D1}\uFE0F"),this.h()},l(m){e=h(m,"DIV",{class:!0});var b=_(e);t=h(b,"BUTTON",{class:!0});var U=_(t);l=M(U,"\u270F\uFE0F"),U.forEach(n),r=V(b),i=h(b,"BUTTON",{class:!0});var g=_(i);c=M(g,"\u{1F5D1}\uFE0F"),g.forEach(n),b.forEach(n),this.h()},h(){d(t,"class","p-1.5 bg-blue-600 text-white rounded text-xs hover:bg-blue-700"),d(i,"class","p-1.5 bg-red-600 text-white rounded text-xs hover:bg-red-700"),d(e,"class","absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1")},m(m,b){B(m,e,b),s(e,t),s(t,l),s(e,r),s(e,i),s(i,c),o||(f=[J(t,"click",k),J(i,"click",y)],o=!0)},p(m,b){a=m},d(m){m&&n(e),o=!1,Ze(f)}}}function Xe(a,e){let t,l,r,i,c,o,f,k=e[38].title+"",y,m,b,U,g,v;function z(x,C){return x[38].coverUrl?zt:yt}let j=z(e),E=j(e),I=e[38].description&&qe(e),w=e[12]&&Je(e);function L(){return e[34](e[38])}return{key:a,first:null,c(){t=u("div"),l=u("div"),E.c(),r=T(),i=u("div"),c=T(),o=u("div"),f=u("h3"),y=D(k),m=T(),I&&I.c(),b=T(),w&&w.c(),U=T(),this.h()},l(x){t=h(x,"DIV",{class:!0});var C=_(t);l=h(C,"DIV",{class:!0});var A=_(l);E.l(A),r=V(A),i=h(A,"DIV",{class:!0}),_(i).forEach(n),c=V(A),o=h(A,"DIV",{class:!0});var H=_(o);f=h(H,"H3",{class:!0});var R=_(f);y=M(R,k),R.forEach(n),m=V(H),I&&I.l(H),H.forEach(n),b=V(A),w&&w.l(A),A.forEach(n),U=V(C),C.forEach(n),this.h()},h(){d(i,"class","absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"),d(f,"class","text-white font-semibold text-sm truncate"),d(o,"class","absolute bottom-0 left-0 right-0 p-3"),d(l,"class","relative rounded-lg overflow-hidden shadow-xl bg-black/30 aspect-[3/4]"),d(t,"class","magazine-card relative group cursor-pointer transform transition-all duration-200 hover:scale-105 svelte-1osbdr4"),this.first=t},m(x,C){B(x,t,C),s(t,l),E.m(l,null),s(l,r),s(l,i),s(l,c),s(l,o),s(o,f),s(f,y),s(o,m),I&&I.m(o,null),s(l,b),w&&w.m(l,null),s(t,U),g||(v=J(t,"click",L),g=!0)},p(x,C){e=x,j===(j=z(e))&&E?E.p(e,C):(E.d(1),E=j(e),E&&(E.c(),E.m(l,r))),C[0]&32&&k!==(k=e[38].title+"")&&$(y,k),e[38].description?I?I.p(e,C):(I=qe(e),I.c(),I.m(o,null)):I&&(I.d(1),I=null),e[12]?w?w.p(e,C):(w=Je(e),w.c(),w.m(l,null)):w&&(w.d(1),w=null)},d(x){x&&n(t),E.d(),I&&I.d(),w&&w.d(),g=!1,v()}}}function It(a){let e,t;return{c(){e=u("p"),t=D("Check back later for magazine content"),this.h()},l(l){e=h(l,"P",{class:!0});var r=_(e);t=M(r,"Check back later for magazine content"),r.forEach(n),this.h()},h(){d(e,"class","text-sm")},m(l,r){B(l,e,r),s(e,t)},d(l){l&&n(e)}}}function Dt(a){let e,t;return{c(){e=u("p"),t=D('Click "Add Magazine" to create your first magazine'),this.h()},l(l){e=h(l,"P",{class:!0});var r=_(e);t=M(r,'Click "Add Magazine" to create your first magazine'),r.forEach(n),this.h()},h(){d(e,"class","text-sm")},m(l,r){B(l,e,r),s(e,t)},d(l){l&&n(e)}}}function Mt(a){let e,t;return{c(){e=u("div"),t=D("No embed URL configured for this magazine"),this.h()},l(l){e=h(l,"DIV",{class:!0});var r=_(e);t=M(r,"No embed URL configured for this magazine"),r.forEach(n),this.h()},h(){d(e,"class","absolute inset-0 flex items-center justify-center text-gray-400")},m(l,r){B(l,e,r),s(e,t)},p:be,d(l){l&&n(e)}}}function Ut(a){let e,t,l;return{c(){e=u("iframe"),this.h()},l(r){e=h(r,"IFRAME",{src:!0,class:!0,title:!0,allow:!0}),_(e).forEach(n),this.h()},h(){ce(e.src,t=ve(a[4].embedUrl))||d(e,"src",t),d(e,"class","absolute inset-0 w-full h-full border-0"),d(e,"title",l=a[4].title),e.allowFullscreen=!0,d(e,"allow","fullscreen")},m(r,i){B(r,e,i)},p(r,i){i[0]&16&&!ce(e.src,t=ve(r[4].embedUrl))&&d(e,"src",t),i[0]&16&&l!==(l=r[4].title)&&d(e,"title",l)},d(r){r&&n(e)}}}function Tt(a){let e,t;return{c(){e=u("div"),t=D("No cover"),this.h()},l(l){e=h(l,"DIV",{class:!0});var r=_(e);t=M(r,"No cover"),r.forEach(n),this.h()},h(){d(e,"class","w-24 h-32 bg-white/10 rounded flex items-center justify-center text-gray-400 text-xs")},m(l,r){B(l,e,r),s(e,t)},p:be,d(l){l&&n(e)}}}function Vt(a){let e,t;return{c(){e=u("img"),this.h()},l(l){e=h(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ce(e.src,t=a[8].coverUrl)||d(e,"src",t),d(e,"alt","Cover"),d(e,"class","w-24 h-32 object-cover rounded shadow")},m(l,r){B(l,e,r)},p(l,r){r[0]&256&&!ce(e.src,t=l[8].coverUrl)&&d(e,"src",t)},d(l){l&&n(e)}}}function Ke(a){let e,t,l=(ve(a[8].embedUrl)||"Invalid")+"",r;return{c(){e=u("p"),t=D("Detected URL: "),r=D(l),this.h()},l(i){e=h(i,"P",{class:!0});var c=_(e);t=M(c,"Detected URL: "),r=M(c,l),c.forEach(n),this.h()},h(){d(e,"class","text-xs text-green-400 mt-1")},m(i,c){B(i,e,c),s(e,t),s(e,r)},p(i,c){c[0]&256&&l!==(l=(ve(i[8].embedUrl)||"Invalid")+"")&&$(r,l)},d(i){i&&n(e)}}}function Qe(a){let e,t,l;return{c(){e=u("p"),t=D(a[11]),this.h()},l(r){e=h(r,"P",{class:!0});var i=_(e);t=M(i,a[11]),i.forEach(n),this.h()},h(){d(e,"class",l="text-sm "+(a[11].includes("saved")?"text-green-400":"text-red-400"))},m(r,i){B(r,e,i),s(e,t)},p(r,i){i[0]&2048&&$(t,r[11]),i[0]&2048&&l!==(l="text-sm "+(r[11].includes("saved")?"text-green-400":"text-red-400"))&&d(e,"class",l)},d(r){r&&n(e)}}}function Ye(a){let e,t;return{c(){e=u("div"),t=D(a[11]),this.h()},l(l){e=h(l,"DIV",{class:!0});var r=_(e);t=M(r,a[11]),r.forEach(n),this.h()},h(){d(e,"class","absolute bottom-4 right-4 px-4 py-2 bg-green-600 text-white rounded shadow-lg")},m(l,r){B(l,e,r),s(e,t)},p(l,r){r[0]&2048&&$(t,l[11])},d(l){l&&n(e)}}}function xt(a){let e,t;function l(o,f){return o[6]?wt:o[7]?gt:o[3]==="viewer"&&o[4]?bt:vt}let r=l(a),i=r(a),c=a[11]&&!a[7]&&Ye(a);return{c(){e=u("div"),i.c(),t=T(),c&&c.c(),this.h()},l(o){e=h(o,"DIV",{slot:!0,class:!0});var f=_(e);i.l(f),t=V(f),c&&c.l(f),f.forEach(n),this.h()},h(){d(e,"slot","content"),d(e,"class","magazine-container absolute inset-1 top-0 flex flex-col bg-gradient-to-b from-[#1a1a2e] to-[#16213e] overflow-hidden svelte-1osbdr4")},m(o,f){B(o,e,f),i.m(e,null),s(e,t),c&&c.m(e,null)},p(o,f){r===(r=l(o))&&i?i.p(o,f):(i.d(1),i=r(o),i&&(i.c(),i.m(e,t))),o[11]&&!o[7]?c?c.p(o,f):(c=Ye(o),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(o){o&&n(e),i.d(),c&&c.d()}}}function Nt(a){let e,t,l,r,i={options:a[1],on_click_close:a[2],$$slots:{content:[xt]},$$scope:{ctx:a}};return e=new ht({props:i}),a[35](e),{c(){lt(e.$$.fragment)},l(c){rt(e.$$.fragment,c)},m(c,o){st(e,c,o),t=!0,l||(r=J(mt,"keydown",a[21]),l=!0)},p(c,o){const f={};o[0]&2&&(f.options=c[1]),o[0]&8184|o[1]&1024&&(f.$$scope={dirty:o,ctx:c}),e.$set(f)},i(c){t||(it(e.$$.fragment,c),t=!0)},o(c){at(e.$$.fragment,c),t=!1},d(c){a[35](null),ot(e,c),l=!1,r()}}}function ve(a){if(!a)return null;const e=a.match(/src=["']([^"']+)["']/i);return e&&e[1]?e[1]:a.startsWith("http")?a:null}function Pt(a,e,t){let l;nt(a,pt,p=>t(12,l=p));let{id:r}=e,{window:i}=e,{self:c}=e,{parentNode:o}=e,{exec_path:f}=e,{openMagazineId:k=null}=e,y="gallery",m=null,b=[],U=!0,g=!1,v=null,z,j=!1,E="",{options:I={title:"Magazine Portfolio",min_width:800,min_height:600,width:1e3,height:700,icon:"/images/xp/icons/MagazinePortfolio.png",id:r,exec_path:f}}=e;ct(async()=>{if(await w(),k){const p=b.find(N=>N.id===k);p&&L(p)}});async function w(){t(6,U=!0);try{const N=await(await fetch("/api/admin/magazines")).json();N.success?t(5,b=N.magazines||[]):t(5,b=[])}catch(p){console.error("Error loading magazines:",p),t(5,b=[])}t(6,U=!1)}function L(p){t(4,m=p),t(3,y="viewer")}function x(){t(3,y="gallery"),t(4,m=null)}function C(){!l||(t(8,v={id:"new_"+Date.now(),title:"",description:"",coverUrl:"",embedUrl:"",createdAt:Date.now()}),t(7,g=!0))}function A(p,N){!l||(N&&N.stopPropagation(),t(8,v={...p}),t(7,g=!0))}function H(){t(8,v=null),t(7,g=!1),t(11,E="")}async function R(){if(!(!l||!v)){if(!v.title||v.title.trim()===""){t(11,E="Title is required");return}t(10,j=!0);try{const N=await(await fetch("/api/admin/magazines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({magazine:v})})).json();N.success?(await w(),H(),t(11,E="Magazine saved!"),setTimeout(()=>t(11,E=""),3e3)):t(11,E=N.error||"Failed to save")}catch(p){console.error("Error saving magazine:",p),t(11,E="Error saving magazine")}t(10,j=!1)}}async function W(p,N){if(!!l&&(N&&N.stopPropagation(),!!confirm(`Delete "${p.title}"?`)))try{(await(await fetch("/api/admin/magazines",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p.id})})).json()).success&&await w()}catch(le){console.error("Error deleting magazine:",le)}}async function de(){if(!!z?.files?.length){t(10,j=!0);try{const p=z.files[0],N=new FormData;N.append("file",p),N.append("fileId","magazine_cover_"+Date.now());const q=await(await fetch("/api/admin/upload",{method:"POST",body:N})).json();q.success?(t(8,v.coverUrl=q.url,v),t(8,v)):t(11,E=q.error||"Failed to upload cover")}catch(p){console.error("Error uploading cover:",p),t(11,E="Error uploading cover")}t(10,j=!1)}}async function Q(){se()}function se(){_t.update(p=>p.filter(N=>N!=c)),c.$destroy()}function oe(p){y==="viewer"&&p.key==="Escape"&&x()}function fe(){v.title=this.value,t(8,v)}function G(){v.description=this.value,t(8,v)}function ee(p){Re[p?"unshift":"push"](()=>{z=p,t(9,z)})}const ue=()=>z.click();function he(){v.embedUrl=this.value,t(8,v)}const X=(p,N)=>A(p,N),_e=(p,N)=>W(p,N),te=p=>L(p);function pe(p){Re[p?"unshift":"push"](()=>{i=p,t(0,i)})}return a.$$set=p=>{"id"in p&&t(22,r=p.id),"window"in p&&t(0,i=p.window),"self"in p&&t(23,c=p.self),"parentNode"in p&&t(24,o=p.parentNode),"exec_path"in p&&t(25,f=p.exec_path),"openMagazineId"in p&&t(26,k=p.openMagazineId),"options"in p&&t(1,I=p.options)},[i,I,Q,y,m,b,U,g,v,z,j,E,l,L,x,C,A,H,R,W,de,oe,r,c,o,f,k,fe,G,ee,ue,he,X,_e,te,pe]}class Gt extends $e{constructor(e){super(),et(this,e,Pt,Nt,tt,{id:22,window:0,self:23,parentNode:24,exec_path:25,openMagazineId:26,options:1,destroy:2},null,[-1,-1])}get id(){return this.$$.ctx[22]}set id(e){this.$$set({id:e}),ae()}get window(){return this.$$.ctx[0]}set window(e){this.$$set({window:e}),ae()}get self(){return this.$$.ctx[23]}set self(e){this.$$set({self:e}),ae()}get parentNode(){return this.$$.ctx[24]}set parentNode(e){this.$$set({parentNode:e}),ae()}get exec_path(){return this.$$.ctx[25]}set exec_path(e){this.$$set({exec_path:e}),ae()}get openMagazineId(){return this.$$.ctx[26]}set openMagazineId(e){this.$$set({openMagazineId:e}),ae()}get options(){return this.$$.ctx[1]}set options(e){this.$$set({options:e}),ae()}get destroy(){return this.$$.ctx[2]}}export{Gt as default};
