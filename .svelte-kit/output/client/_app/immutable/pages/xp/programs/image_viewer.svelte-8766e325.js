import{S as Q,i as Y,X as S,s as $,w as tt,x as et,y as st,O as R,f as nt,t as it,B as ot,P as J,o as lt,W as rt,l as E,a as W,K as L,m as z,n as m,h as d,c as j,M,p as i,b as at,J as a,E as ct,R as ut,_ as X}from"../../../chunks/index-7043d62e.js";import{W as ft}from"../../../chunks/Window-b5e17ac1.js";import{h as ht,z as dt,r as mt}from"../../../chunks/store-a53f3f11.js";import{g as wt}from"../../../chunks/index-e9763cd9.js";import"../../../chunks/TitleBar-43a93d4a.js";import"../../../chunks/utils-1f7a3290.js";import"../../../chunks/lodash-b0811ec1.js";import"../../../chunks/_commonjsHelpers-cea7ac1a.js";import"../../../chunks/index-bc59e2a0.js";import"../../../chunks/system-e72d84b7.js";const{window:gt}=rt;function _t(r){let e,n,o,y,g,s,f,w,c,I,l,_,V,D,v,p,N,A,x,b,O,H,U;return{c(){e=E("div"),n=E("div"),o=E("img"),y=W(),g=E("div"),s=E("div"),f=E("button"),w=L("svg"),c=L("path"),I=W(),l=E("button"),_=L("svg"),V=L("path"),D=W(),v=E("button"),p=L("svg"),N=L("path"),A=W(),x=E("button"),b=L("svg"),O=L("path"),this.h()},l(T){e=z(T,"DIV",{slot:!0,class:!0});var k=m(e);n=z(k,"DIV",{class:!0});var t=m(n);o=z(t,"IMG",{class:!0,alt:!0}),t.forEach(d),y=j(k),g=z(k,"DIV",{class:!0});var u=m(g);s=z(u,"DIV",{class:!0});var h=m(s);f=z(h,"BUTTON",{class:!0});var B=m(f);w=M(B,"svg",{class:!0,xmlns:!0,viewBox:!0});var C=m(w);c=M(C,"path",{d:!0}),m(c).forEach(d),C.forEach(d),B.forEach(d),I=j(h),l=z(h,"BUTTON",{class:!0});var P=m(l);_=M(P,"svg",{class:!0,xmlns:!0,viewBox:!0});var K=m(_);V=M(K,"path",{d:!0}),m(V).forEach(d),K.forEach(d),P.forEach(d),D=j(h),v=z(h,"BUTTON",{class:!0});var Z=m(v);p=M(Z,"svg",{class:!0,xmlns:!0,viewBox:!0});var q=m(p);N=M(q,"path",{d:!0}),m(N).forEach(d),q.forEach(d),Z.forEach(d),A=j(h),x=z(h,"BUTTON",{class:!0});var F=m(x);b=M(F,"svg",{class:!0,xmlns:!0,viewBox:!0});var G=m(b);O=M(G,"path",{d:!0}),m(O).forEach(d),G.forEach(d),F.forEach(d),h.forEach(d),u.forEach(d),k.forEach(d),this.h()},h(){i(o,"class","max-w-full max-h-full outline-none"),i(o,"alt",""),i(n,"class","grow w-full overflow-hidden flex items-center justify-center p-2 outline-none"),i(c,"d","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM184 296c0 13.3 10.7 24 24 24s24-10.7 24-24V232h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H232V120c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"),i(w,"class","w-full h-full fill-blue-600"),i(w,"xmlns","http://www.w3.org/2000/svg"),i(w,"viewBox","0 0 512 512"),i(f,"class","w-4 h-4 outline-none"),i(V,"d","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM136 184c-13.3 0-24 10.7-24 24s10.7 24 24 24H280c13.3 0 24-10.7 24-24s-10.7-24-24-24H136z"),i(_,"class","w-full h-full fill-blue-600"),i(_,"xmlns","http://www.w3.org/2000/svg"),i(_,"viewBox","0 0 512 512"),i(l,"class","w-4 h-4 outline-none"),i(N,"d","M459.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4L288 214.3V256v41.7L459.5 440.6zM256 352V256 128 96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160C4.2 237.5 0 246.5 0 256s4.2 18.5 11.5 24.6l192 160c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V352z"),i(p,"class","w-full h-full fill-blue-600"),i(p,"xmlns","http://www.w3.org/2000/svg"),i(p,"viewBox","0 0 512 512"),i(v,"class","w-4 h-4 outline-none"),i(O,"d","M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4L224 214.3V256v41.7L52.5 440.6zM256 352V256 128 96c0-12.4 7.2-23.7 18.4-29s24.5-3.6 34.1 4.4l192 160c7.3 6.1 11.5 15.1 11.5 24.6s-4.2 18.5-11.5 24.6l-192 160c-9.5 7.9-22.8 9.7-34.1 4.4s-18.4-16.6-18.4-29V352z"),i(b,"class","w-full h-full fill-blue-600"),i(b,"xmlns","http://www.w3.org/2000/svg"),i(b,"viewBox","0 0 512 512"),i(x,"class","w-4 h-4 outline-none"),i(s,"class","mx-auto flex flex-row items-center justify-evenly w-[200px]"),i(g,"class","h-[40px] shrink-0 flex items-center"),i(e,"slot","content"),i(e,"class","absolute inset-1 flex flex-col bg-slate-100")},m(T,k){at(T,e,k),a(e,n),a(n,o),r[14](o),a(e,y),a(e,g),a(g,s),a(s,f),a(f,w),a(w,c),a(s,I),a(s,l),a(l,_),a(_,V),a(s,D),a(s,v),a(v,p),a(p,N),a(s,A),a(s,x),a(x,b),a(b,O),H||(U=[R(f,"click",r[7]),R(l,"click",r[8]),R(v,"click",r[6]),R(x,"click",r[5])],H=!0)},p:ct,d(T){T&&d(e),r[14](null),H=!1,ut(U)}}}function pt(r){let e,n,o,y,g={options:r[2],on_click_close:r[1],$$slots:{content:[_t]},$$scope:{ctx:r}};return e=new ft({props:g}),r[15](e),{c(){tt(e.$$.fragment)},l(s){et(e.$$.fragment,s)},m(s,f){st(e,s,f),n=!0,o||(y=R(gt,"keydown",r[4]),o=!0)},p(s,[f]){const w={};f&4&&(w.options=s[2]),f&8388616&&(w.$$scope={dirty:f,ctx:s}),e.$set(w)},i(s){n||(nt(e.$$.fragment,s),n=!0)},o(s){it(e.$$.fragment,s),n=!1},d(s){r[15](null),ot(e,s),o=!1,y()}}}function vt(r,e,n){let o,y;J(r,ht,t=>n(17,o=t)),J(r,dt,t=>n(18,y=t));let{id:g}=e,{window:s}=e,{self:f}=e,{parentNode:w}=e,{fs_item:c}=e,{exec_path:I}=e,l,_,V=[".bmp",".jpg",".jpeg",".png",".webp"];lt(async()=>{await p(c.id),_=panzoom(l,{filterKey(t){if(t.key=="ArrowRight"||t.key=="ArrowLeft")return!0}})});async function D(){mt.update(t=>t.filter(u=>u!=f)),f.$destroy()}let{options:v={title:c==null?"Image Viewer":c.name,min_width:300,min_height:300,width:600,height:400,icon:"/images/xp/icons/WindowsPictureandFaxViewer.png",id:g,exec_path:I}}=e;async function p(t){let u=o[t],h=null;if(u.storage_type=="remote")h=u.url;else if(u.storage_type=="local"){let B=await wt(u.url);h=URL.createObjectURL(B)}n(3,l.src=h,l)}async function N(t){s.z_index==y&&(!["ArrowRight","ArrowLeft"].includes(t.key)||(t.key=="ArrowRight"?await A():t.key=="ArrowLeft"&&await x()))}async function A(){n(9,c=H(c)),await p(c.id),n(3,l.style.transform="none",l)}async function x(){n(9,c=U(c)),await p(c.id),n(3,l.style.transform="none",l)}function b(){_.smoothZoom(l.clientWidth*.5,l.clientHeight*.5,1.2)}function O(){_.smoothZoom(l.clientWidth*.5,l.clientHeight*.5,.8)}function H(t){console.log(o[t.parent]);let u=o[t.parent].children.filter(B=>V.includes(o[B].ext)),h=u.indexOf(t.id);return h==u.length-1?o[u[0]]:o[u[h+1]]}function U(t){let u=o[t.parent].children.filter(B=>V.includes(o[B].ext)),h=u.indexOf(t.id);return h==0?o[u[u.length-1]]:o[u[h-1]]}function T(t){X[t?"unshift":"push"](()=>{l=t,n(3,l)})}function k(t){X[t?"unshift":"push"](()=>{s=t,n(0,s)})}return r.$$set=t=>{"id"in t&&n(10,g=t.id),"window"in t&&n(0,s=t.window),"self"in t&&n(11,f=t.self),"parentNode"in t&&n(12,w=t.parentNode),"fs_item"in t&&n(9,c=t.fs_item),"exec_path"in t&&n(13,I=t.exec_path),"options"in t&&n(2,v=t.options)},r.$$.update=()=>{r.$$.dirty&513&&c&&s&&s.update_title(c.name)},[s,D,v,l,N,A,x,b,O,c,g,f,w,I,T,k]}class It extends Q{constructor(e){super(),Y(this,e,vt,pt,$,{id:10,window:0,self:11,parentNode:12,fs_item:9,exec_path:13,destroy:1,options:2})}get id(){return this.$$.ctx[10]}set id(e){this.$$set({id:e}),S()}get window(){return this.$$.ctx[0]}set window(e){this.$$set({window:e}),S()}get self(){return this.$$.ctx[11]}set self(e){this.$$set({self:e}),S()}get parentNode(){return this.$$.ctx[12]}set parentNode(e){this.$$set({parentNode:e}),S()}get fs_item(){return this.$$.ctx[9]}set fs_item(e){this.$$set({fs_item:e}),S()}get exec_path(){return this.$$.ctx[13]}set exec_path(e){this.$$set({exec_path:e}),S()}get destroy(){return this.$$.ctx[1]}get options(){return this.$$.ctx[2]}set options(e){this.$$set({options:e}),S()}}export{It as default};
