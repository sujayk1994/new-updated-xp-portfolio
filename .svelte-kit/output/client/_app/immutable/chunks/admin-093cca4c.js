import{w as i}from"./index-bc59e2a0.js";import"./system-e72d84b7.js";import{T as c}from"./index-7043d62e.js";const t=i(!1),a=i(null),o=i(!1),d=i(!1);async function p(){try{const e=await(await fetch("/api/admin/verify")).json();return e.authenticated?(t.set(!0),a.set(e.admin)):(t.set(!1),a.set(null)),e.authenticated}catch(r){return console.error("Error checking admin status:",r),!1}}async function m(r,e){o.set(!0);try{const n=await(await fetch("/api/admin/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"login",username:r,password:e})})).json();return n.success?(t.set(!0),a.set(n.admin),d.set(!1),{success:!0}):{success:!1,error:n.error||"Login failed"}}catch(s){return console.error("Login error:",s),{success:!1,error:"Connection error"}}finally{o.set(!1)}}async function h(r,e){o.set(!0);try{const n=await(await fetch("/api/admin/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"register",username:r,password:e})})).json();return n.success?(t.set(!0),a.set(n.admin),d.set(!1),{success:!0}):{success:!1,error:n.error||"Registration failed"}}catch(s){return console.error("Registration error:",s),{success:!1,error:"Connection error"}}finally{o.set(!1)}}async function y(){try{await fetch("/api/admin/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"logout"})}),t.set(!1),a.set(null),window.location.reload()}catch(r){console.error("Logout error:",r)}}async function g(){try{return(await(await fetch("/api/admin/auth")).json()).adminExists}catch(r){return console.error("Error checking admin exists:",r),!1}}async function w(){try{const e=await(await fetch("/api/admin/files")).json();return e.success&&e.files?e.files:{}}catch(r){return console.error("Error loading admin files:",r),{}}}async function j(r){if(!c(t))return{success:!1,error:"Not authenticated"};try{return await(await fetch("/api/admin/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"create",file:r})})).json()}catch(e){return console.error("Error saving admin file:",e),{success:!1,error:e.message}}}async function S(r){if(!c(t))return{success:!1,error:"Not authenticated"};try{return await(await fetch("/api/admin/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete",file:{id:r}})})).json()}catch(e){return console.error("Error deleting admin file:",e),{success:!1,error:e.message}}}async function T(r,e){if(!c(t))return{success:!1,error:"Not authenticated"};try{return await(await fetch("/api/admin/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update_children",file:{id:r,children:e}})})).json()}catch(s){return console.error("Error updating admin children:",s),{success:!1,error:s.message}}}async function O(r,e){if(!c(t))return{success:!1,error:"Not authenticated"};try{const s=new FormData;return s.append("file",r),s.append("fileId",e),await(await fetch("/api/admin/upload",{method:"POST",body:s})).json()}catch(s){return console.error("Error uploading admin file:",s),{success:!1,error:s.message}}}export{g as a,a as b,p as c,o as d,h as e,m as f,y as g,j as h,t as i,T as j,S as k,w as l,d as s,O as u};
