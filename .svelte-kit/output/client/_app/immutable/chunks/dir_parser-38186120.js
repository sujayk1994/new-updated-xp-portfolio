import{c as ct}from"./_commonjsHelpers-cea7ac1a.js";var pe={exports:{}};(function(g,m){(function(b,y){g.exports=y()})(ct,function(){function b(r,n){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,t,s,o,l=[],c=!0,d=!1;try{if(s=(e=e.call(r)).next,n===0){if(Object(e)!==e)return;c=!1}else for(;!(c=(i=s.call(e)).done)&&(l.push(i.value),l.length!==n);c=!0);}catch(S){d=!0,t=S}finally{try{if(!c&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(d)throw t}}return l}}function y(r,n){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);n&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})),e.push.apply(e,i)}return e}function u(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?y(Object(e),!0).forEach(function(i){a(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):y(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function h(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function v(r,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,ee(i.key),i)}}function p(r,n,e){return n&&v(r.prototype,n),e&&v(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function a(r,n,e){return n=ee(n),n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function J(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),n&&V(r,n)}function P(r){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(r)}function V(r,n){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,t){return i.__proto__=t,i},V(r,n)}function Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B(r,n,e){return Q()?B=Reflect.construct.bind():B=function(t,s,o){var l=[null];l.push.apply(l,s);var c=Function.bind.apply(t,l),d=new c;return o&&V(d,o.prototype),d},B.apply(null,arguments)}function me(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function H(r){var n=typeof Map=="function"?new Map:void 0;return H=function(i){if(i===null||!me(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(i))return n.get(i);n.set(i,t)}function t(){return B(i,arguments,P(this).constructor)}return t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),V(t,i)},H(r)}function I(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ye(r,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I(r)}function F(r){var n=Q();return function(){var i=P(r),t;if(n){var s=P(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return ye(this,t)}}function be(r,n){for(;!Object.prototype.hasOwnProperty.call(r,n)&&(r=P(r),r!==null););return r}function E(){return typeof Reflect<"u"&&Reflect.get?E=Reflect.get.bind():E=function(n,e,i){var t=be(n,e);if(!!t){var s=Object.getOwnPropertyDescriptor(t,e);return s.get?s.get.call(arguments.length<3?n:i):s.value}},E.apply(this,arguments)}function W(r,n){return _e(r)||b(r,n)||G(r,n)||Ae()}function L(r){return De(r)||Pe(r)||G(r)||Ie()}function De(r){if(Array.isArray(r))return Y(r)}function _e(r){if(Array.isArray(r))return r}function Pe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function G(r,n){if(!!r){if(typeof r=="string")return Y(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Y(r,n)}}function Y(r,n){(n==null||n>r.length)&&(n=r.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=r[e];return i}function Ie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Te(r,n){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=G(r))||n&&r&&typeof r.length=="number"){e&&(r=e);var i=0,t=function(){};return{s:t,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(r)},n:function(){var c=e.next();return s=c.done,c},e:function(c){o=!0,l=c},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Ee(r,n){if(typeof r!="object"||r===null)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,n||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function ee(r){var n=Ee(r,"string");return typeof n=="symbol"?n:String(n)}var A=function(n,e,i){var t=n.x,s=n.y,o=i.x,l=i.y,c={"+":{x:t+o,y:s+l},"-":{x:t-o,y:s-l},"*":{x:t*o,y:s*l},"/":{x:t/o,y:s/l}};return c[e]},M=function(n){return{x:n.left,y:n.top}},te=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{left:n.x,top:n.y,right:n.x,bottom:n.y,width:e,height:e}},Le=function(n){return{x:n,y:n}},re=function(r,n){var e=n;window.addEventListener("resize",e),window.addEventListener("scroll",e);var i=new MutationObserver(e);r.forEach(function(s,o){i.observe(s,{childList:o!==0,attributes:!0})});var t=function(){return ze(i,e)};return{observer:i,callback:e,cleanup:t}},xe=function(r){var n=j(r);return n.x||n.y?!0:r instanceof Document?r.body?!!(r.body.scrollTop=1):!!(r.documentElement.scrollTop=1):!!(r.scrollTop=1)},Ce=function(){var r=document.createElement("div");return r.style.position="fixed",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.zIndex="999999999999999999",r},we=function(r){var n=document.createElement("div");return n.style.position="absolute",r||(n.style.background="rgba(0, 175, 255, 0.2)",n.style.border="1px solid rgba(0, 175, 255, 0.8)",n.style.display="none",n.style.pointerEvents="none"),n},ne=function(r,n){var e;return function(){for(var i=arguments.length,t=new Array(i),s=0;s<i;s++)t[s]=arguments[s];var o=function(){e=null,r.apply(void 0,t)};clearTimeout(e),e=setTimeout(o,n)}},U=function(){var r,n,e,i;return{y:((r=document.body)===null||r===void 0?void 0:r.scrollTop)||((n=document.documentElement)===null||n===void 0?void 0:n.scrollTop)||0,x:((e=document.body)===null||e===void 0?void 0:e.scrollLeft)||((i=document.documentElement)===null||i===void 0?void 0:i.scrollLeft)||0}},se=function(r){var n=function e(i){var t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=(t=i[s])===null||t===void 0?void 0:t.parentNode;return o?(i.push(o),s++,e(i,s)):i};return n([r])},Ne=function(r,n){if(r instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var e=r.getBoundingClientRect();return{top:e.top,left:e.left,bottom:e.bottom,right:e.right,width:(r.clientWidth||e.width)*n,height:(r.clientHeight||e.height)*n}},ie=function(r,n){var e={top:Number.POSITIVE_INFINITY,left:Number.POSITIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,right:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY};return N(r).forEach(function(i){var t=n.getRect(i);e.top=Math.min(e.top,t.top),e.left=Math.min(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}),e.height=e.bottom-e.top,e.width=e.right-e.left,e},j=function(r){return!r||r instanceof Document?U():{x:r.scrollLeft>=0?r.scrollLeft:U().x,y:r.scrollTop>=0?r.scrollTop:U().y}},oe=function(r){var n=r.elementRect,e=r.containerRect,i=r.tolerance,t=i===void 0?{x:0,y:0}:i,s=[];return n.top-t.y<e.top&&s.push("top"),n.left-t.x<e.left&&s.push("left"),n.bottom+t.y>e.bottom&&s.push("bottom"),n.right+t.y>e.right&&s.push("right"),s},Me=function(r){var n=r.event;return{x:n.clientX,y:n.clientY}},ke=function(r){var n=r.scrollAmount,e=r.initialPointerPos,i=r.pointerPos,t={};return i.x>e.x-n.x?(t.left=e.x-n.x,t.width=i.x-e.x+n.x):(t.left=i.x,t.width=e.x-i.x-n.x),i.y>e.y-n.y?(t.top=e.y-n.y,t.height=i.y-e.y+n.y):(t.top=i.y,t.height=e.y-i.y-n.y),t},ae=function(n){var e={x:0,y:0},i=window.getComputedStyle(n);if(!i.transform||i.transform==="none")return e;if(i.transform.indexOf("3d")>=0){var t=i.transform.trim().match(/matrix3d\((.*?)\)/);if(t&&t.length){var s,o=(s=t[1])===null||s===void 0?void 0:s.split(",");e.x=parseInt(o[12])||0,e.y=parseInt(o[13])||0}return e}var l=i.transform.trim().match(/matrix\((.*?)\)/);if(l&&l.length){var c,d=(c=l[1])===null||c===void 0?void 0:c.split(",");e.x=parseInt(d[4])||0,e.y=parseInt(d[5])||0}return e},Ve=function(n){var e=n.style.transform;if(!e||e.indexOf("translate")<0)return ae(n);var i={x:0,y:0},t=e.trim().match(/translate[3dD]*?\(.*?\)/);if(t){var s,o=(s=t[0])===null||s===void 0?void 0:s.split("(");if(o){var l,c=(l=o[1])===null||l===void 0?void 0:l.split(",");i.x=parseInt(c[0])||0,i.y=parseInt(c[1])||0}}return!i.x&&!i.x?ae(n):i},Re=function(n){var e=n.style,i={x:parseInt(e.left)||0,y:parseInt(e.top)||0};if(!i.x&&!i.x){var t=window.getComputedStyle(n);return{x:parseInt(t.left)||0,y:parseInt(t.top)||0}}return i},Oe=function(r,n){return n?Ve(r):Re(r)},Ke=function(r){var n=r.element,e=r.edges,i=r.elementRect,t=r.containerRect,s=r.elementPos,o=r.useTransform;e.includes("top")&&O(n,{y:s.y+t.top-i.top,x:s.x},o),e.includes("left")&&O(n,{y:s.y,x:s.x+t.left-i.left},o),e.includes("bottom")&&O(n,{y:s.y+t.bottom-i.bottom,x:s.x},o),e.includes("right")&&O(n,{y:s.y,x:s.x+t.right-i.right},o)},le=function(r){var n=r.computedStyle,e=r.node,i=n.position,t=i==="absolute"||i==="relative"||i==="fixed";!(e instanceof Document)&&!t&&(e.style.position="relative")},Ze=function(r){var n=r.shiftKey,e=r.keyboardDragSpeed,i=r.zoom,t=r.key,s=r.dragKeys,o=r.scrollDiff,l=r.canScroll,c=r.scrollCallback,d={x:0,y:0},S=n?e*4*i:e*i;return s.left.includes(t)&&(d.x=o.x||-S,!n&&!o.x&&l&&c(["left"],e)),s.right.includes(t)&&(d.x=o.x||S,!n&&!o.x&&l&&c(["right"],e)),s.up.includes(t)&&(d.y=o.y||-S,!n&&!o.y&&l&&c(["top"],e)),s.down.includes(t)&&(d.y=o.y||S,!n&&!o.y&&l&&c(["bottom"],e)),d},Be=function(r){var n=r.element,e=r.force,i=r.multiSelectionToggle,t=r.SelectedSet,s=r.hoverClassName;n.classList.contains(s)&&!e||(t.has(n)?i&&t.delete(n):t.add(n),n.classList.add(s))},He=function(r){var n=r.element,e=r.force,i=r.SelectedSet,t=r.PrevSelectedSet,s=r.hoverClassName;if(!n.classList.contains(s)&&!e)return!1;var o=i.has(n),l=t.has(n);o&&!l?i.delete(n):!o&&l&&i.add(n),n.classList.remove(s)},R=function(n,e,i){return console.warn('[DragSelect] TypeIssue: setting "'.concat(n,'" is not of type "').concat(e,'".'))},f=function(n,e,i,t){if(e===void 0)return i?a({},n,t):{};if(e===null)return a({},n,null);var s=!0,o=!1,l=typeof t=="string";l&&(s=typeof e=="string"||e instanceof String),l&&!s&&(o=!0,R(n,"string"));var c=!Number.isNaN(t)&&typeof t=="number";c&&(s=!Number.isNaN(e)&&typeof e=="number"),c&&!s&&(o=!0,R(n,"number"));var d=Object.prototype.toString.call(t)==="[object Object]";d&&(s=Object.prototype.toString.call(e)==="[object Object]"),d&&!s&&(o=!0,R(n,"object"));var S=typeof t=="boolean";S&&(s=typeof e=="boolean"),S&&!s&&(o=!0,R(n,"boolean"));var _=Array.isArray(t);_&&(s=Array.isArray(e)),_&&!s&&(o=!0,R(n,"array"));var x=o||i;return n==="dragKeys"&&s?a({},n,Object.assign(t,e)):n==="dragKeys"&&!s?x?a({},n,t):{}:(n==="dropZones"&&s&&new Set(e.map(function(C){return C.id})).size!==e.length&&console.warn('[DragSelect] UniqueConstraintsIssue: setting "dropZones" contains duplicate ids.'),s?a({},n,e):x?a({},n,t):{})},je=function(r,n){return u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u({},f("area",r.area,n,document)),f("selectables",r.selectables,n,null)),f("autoScrollSpeed",r.autoScrollSpeed,n,5)),f("overflowTolerance",r.overflowTolerance,n,{x:25,y:25})),f("zoom",r.zoom,n,1)),f("customStyles",r.customStyles,n,!1)),f("multiSelectMode",r.multiSelectMode,n,!1)),f("multiSelectToggling",r.multiSelectToggling,n,!0)),f("multiSelectKeys",r.multiSelectKeys,n,["Control","Shift","Meta"])),f("selector",r.selector,n,null)),f("selectionThreshold",r.selectionThreshold,n,0)),f("draggability",r.draggability,n,!0)),f("immediateDrag",r.immediateDrag,n,!0)),f("keyboardDrag",r.keyboardDrag,n,!0)),f("dragKeys",r.dragKeys,n,{up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]})),f("keyboardDragSpeed",r.keyboardDragSpeed,n,10)),f("useTransform",r.useTransform,n,!0)),f("refreshMemoryRate",r.refreshMemoryRate,n,80)),f("dropZones",r.dropZones,n,[])),f("dropInsideThreshold",r.dropInsideThreshold,n,1)),f("dropTargetThreshold",r.dropTargetThreshold,n,0)),f("usePointerEvents",r.usePointerEvents,n,!1)),f("hoverClass",r.hoverClass,n,"ds-hover")),f("selectableClass",r.selectableClass,n,"ds-selectable")),f("selectedClass",r.selectedClass,n,"ds-selected")),f("selectorClass",r.selectorClass,n,"ds-selector")),f("selectorAreaClass",r.selectorAreaClass,n,"ds-selector-area")),f("droppedTargetClass",r.droppedTargetClass,n,"ds-dropped-target")),f("droppedInsideClass",r.droppedInsideClass,n,"ds-dropped-inside")),f("droppableClass",r.droppableClass,n,"ds-droppable")),f("dropZoneClass",r.dropZoneClass,n,"ds-dropzone")),f("dropZoneReadyClass",r.dropZoneReadyClass,n,"ds-dropzone-ready")),f("dropZoneTargetClass",r.dropZoneTargetClass,n,"ds-dropzone-target")),f("dropZoneInsideClass",r.dropZoneInsideClass,n,"ds-dropzone-inside")),f("dragAsBlock",r.dragAsBlock,n,!1))},k=function(r,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=r;if(e>0){var t=(r.right-r.left)*e,s=(r.bottom-r.top)*e;i={left:r.left+t,right:r.right-t,top:r.top+s,bottom:r.bottom-s}}return i.left<n.right&&i.right>n.left&&i.top<n.bottom&&i.bottom>n.top},ce=function(r){var n=r.element,e=r.posDirection,i=r.containerRect,t=r.useTransform,s=Oe(n,t),o=A(s,"+",e);O(n,o,t);var l=n.getBoundingClientRect(),c=oe({elementRect:l,containerRect:i});Ke({element:n,edges:c,elementRect:l,containerRect:i,elementPos:o,useTransform:t})},ze=function(r,n){window.removeEventListener("resize",n),window.removeEventListener("scroll",n),r.disconnect()},$e=function(r,n,e){if(!!n.length){var i=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,t=r instanceof Document?i||document.body:r,s=n.includes("top")&&t.scrollTop>0,o=n.includes("bottom")&&t.scrollTop<t.scrollHeight,l=n.includes("left")&&t.scrollLeft>0,c=n.includes("right")&&t.scrollLeft<t.scrollWidth;s&&(t.scrollTop-=1*e),o&&(t.scrollTop+=1*e),l&&(t.scrollLeft-=1*e),c&&(t.scrollLeft+=1*e)}},O=function(r,n,e){if(e){var i=r.style.transform;r.style.transform="translate3d(".concat(n.x,"px,").concat(n.y,"px,1px) ").concat(i.replace(/translate.*?\)/g,""))}else r.style.left="".concat(n.x,"px"),r.style.top="".concat(n.y,"px");return r},We=function(r){for(var n=r.subscribe,e=r.publish,i=r.Interaction,t=r.SelectedSet,s=r.DropZones,o={"Selected:added":[{name:"elementselect"}],"Selected:removed":[{name:"elementunselect"}],"Area:scroll":[{name:"autoscroll"}],"Interaction:start":[{name:"dragstart"}],"Interaction:update":[{name:"dragmove",condition:function(_){return _.event}}],"Interaction:end":[{name:"callback",extraData:function(){var _=s.getTarget();return u({},_?{dropTarget:_.toObject()}:{})}}]},l=function(){var _=W(d[c],2),x=_[0],C=_[1];["pre",!1].forEach(function(w){return n(w?"".concat(x,":").concat(w):x,function(D){return C.forEach(function(T){return(!T.condition||T.condition(D))&&e(w?"".concat(w).concat(T.name):T.name,u(u({items:t.elements,isDragging:i.isDragging},D),T.extraData?T.extraData(D):{}))})})})},c=0,d=Object.entries(o);c<d.length;c++)l()},N=function(r){return r?!Array.isArray(r)&&(r instanceof HTMLElement||r instanceof SVGElement)?[r]:L(new Set(L(r))):[]},ue=function(r,n){r.style.left="".concat(n.left,"px"),r.style.top="".concat(n.top,"px"),r.style.width="".concat(n.width,"px"),r.style.height="".concat(n.height,"px")},Ge=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"DS",void 0),a(this,"_observers",void 0),a(this,"_node",void 0),a(this,"_parentNodes",void 0),a(this,"_computedStyle",void 0),a(this,"_computedBorder",void 0),a(this,"_rect",void 0),a(this,"setArea",function(t){e.reset(),e._node=t,le({computedStyle:e.computedStyle,node:e._node}),setTimeout(function(){e.DS.PubSub.publish("Area:modified:pre",{item:e}),e.reset(),e.DS.PubSub.publish("Area:modified",{item:e})})}),a(this,"start",function(){e._observers=re(e.parentNodes,ne(function(t){e.DS.PubSub.publish("Area:modified:pre",{event:t,item:e}),e.reset(),e.DS.PubSub.publish("Area:modified",{event:t,item:e})},60))}),a(this,"reset",function(){e._computedStyle=void 0,e._rect=void 0,e._computedBorder=void 0,e._parentNodes=void 0}),a(this,"stop",function(){e._observers.cleanup(),e.reset()}),a(this,"scroll",function(t,s){var o={scroll_directions:t,scroll_multiplier:s};e.DS.PubSub.publish("Area:scroll:pre",o),$e(e._node,t,s),e.DS.PubSub.publish("Area:scroll",o)}),this.DS=i,this.setArea(this.DS.stores.SettingsStore.s.area),this.DS.PubSub.subscribe("Settings:updated:area",function(t){var s=t.settings;e.setArea(s.area)}),this.DS.PubSub.subscribe("Interaction:init",this.start),this.DS.PubSub.subscribe("Interaction:end",this.reset)}return p(r,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof Document?this._computedStyle=window.getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=window.getComputedStyle(this.HTMLNode)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=Ne(this.HTMLNode,this.DS.stores.SettingsStore.s.zoom)}},{key:"parentNodes",get:function(){return this._parentNodes?this._parentNodes:this._parentNodes=se(this.HTMLNode)}}]),r}(),Ye=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_prevCursorPos",void 0),a(this,"_prevScrollPos",void 0),a(this,"_elements",[]),a(this,"_dragKeys",void 0),a(this,"_dragKeysFlat",[]),a(this,"_selectionRect",void 0),a(this,"assignDragkeys",function(){e._dragKeys={up:e.DS.stores.SettingsStore.s.dragKeys.up.map(function(t){return t.toLowerCase()}),down:e.DS.stores.SettingsStore.s.dragKeys.down.map(function(t){return t.toLowerCase()}),left:e.DS.stores.SettingsStore.s.dragKeys.left.map(function(t){return t.toLowerCase()}),right:e.DS.stores.SettingsStore.s.dragKeys.right.map(function(t){return t.toLowerCase()})},e._dragKeysFlat=[].concat(L(e._dragKeys.up),L(e._dragKeys.down),L(e._dragKeys.left),L(e._dragKeys.right))}),a(this,"keyboardDrag",function(t){var s=t.event,o=t.key,l=o.toLowerCase();if(!(!e.DS.stores.SettingsStore.s.keyboardDrag||!e._dragKeysFlat.includes(l)||!e.DS.SelectedSet.size||!e.DS.stores.SettingsStore.s.draggability||e.DS.continue)){var c={event:s,isDragging:!0,isDraggingKeyboard:!0};e.DS.publish(["Interaction:start:pre","Interaction:start"],c),e._elements=e.DS.getSelection(),e.DS.stores.SettingsStore.s.dragAsBlock&&(e._selectionRect=ie(e._elements,e.DS.SelectableSet)),e.handleZIndex(!0);var d=Ze({shiftKey:e.DS.stores.KeyStore.currentValues.includes("shift"),keyboardDragSpeed:e.DS.stores.SettingsStore.s.keyboardDragSpeed,zoom:e.DS.stores.SettingsStore.s.zoom,key:l,scrollCallback:e.DS.Area.scroll,scrollDiff:e._scrollDiff,canScroll:e.DS.stores.ScrollStore.canScroll,dragKeys:e._dragKeys});e.DS.stores.SettingsStore.s.dragAsBlock&&(d=e.limitDirection(d)),e._elements.forEach(function(S){return ce({element:S,posDirection:d,containerRect:e.DS.SelectorArea.rect,useTransform:e.DS.stores.SettingsStore.s.useTransform})}),e.DS.publish(["Interaction:update:pre","Interaction:update"],c)}}),a(this,"keyboardEnd",function(t){var s=t.event,o=t.key,l=o.toLowerCase();if(!(!e.DS.stores.SettingsStore.s.keyboardDrag||!e._dragKeysFlat.includes(l)||!e.DS.SelectedSet.size||!e.DS.stores.SettingsStore.s.draggability)){var c={event:s,isDragging:e.DS.stores.SettingsStore.s.draggability,isDraggingKeyboard:!0};e.DS.publish(["Interaction:end:pre","Interaction:end"],c)}}),a(this,"start",function(t){var s=t.isDragging,o=t.isDraggingKeyboard;!s||o||(e._prevCursorPos=null,e._prevScrollPos=null,e._elements=e.DS.getSelection(),e.DS.stores.SettingsStore.s.dragAsBlock&&(e._selectionRect=ie(e._elements,e.DS.SelectableSet)),e.handleZIndex(!0))}),a(this,"stop",function(t){t!=null&&t.isKeyboard||(e._prevCursorPos=null,e._prevScrollPos=null,e.handleZIndex(!1),e._elements=[])}),a(this,"update",function(t){var s=t.isDragging,o=t.isDraggingKeyboard;if(!(!s||!e._elements.length||o||e.DS.continue)){var l=A(e._cursorDiff,"+",e._scrollDiff);e.DS.stores.SettingsStore.s.dragAsBlock&&(l=e.limitDirection(l)),e._elements.forEach(function(c){return ce({element:c,posDirection:l,containerRect:e.DS.SelectorArea.rect,useTransform:e.DS.stores.SettingsStore.s.useTransform})})}}),a(this,"limitDirection",function(t){var s=e.DS.SelectorArea.rect,o=e.DS.stores.ScrollStore.scrollAmount,l={top:s.top-e._selectionRect.top+o.y,left:s.left-e._selectionRect.left+o.x,bottom:s.bottom-e._selectionRect.bottom+o.y,right:s.right-e._selectionRect.right+o.x};return t.x===0&&t.y===0||(t.y<0&&(t.y=Math.max(t.y,l.top)),t.x<0&&(t.x=Math.max(t.x,l.left)),t.y>0&&(t.y=Math.min(t.y,l.bottom)),t.x>0&&(t.x=Math.min(t.x,l.right)),e._selectionRect.top+=t.y,e._selectionRect.bottom+=t.y,e._selectionRect.left+=t.x,e._selectionRect.right+=t.x),t}),a(this,"handleZIndex",function(t){e._elements.forEach(function(s){return s.style.zIndex="".concat((parseInt(s.style.zIndex)||0)+t?9999:-9998)})}),this.DS=i,this.DS.subscribe("Settings:updated:dragKeys",this.assignDragkeys),this.assignDragkeys(),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("KeyStore:down",this.keyboardDrag),this.DS.subscribe("KeyStore:up",this.keyboardEnd)}return p(r,[{key:"_cursorDiff",get:function(){var e=this.DS.stores.PointerStore.currentVal,i=this._prevCursorPos?A(e,"-",this._prevCursorPos):{x:0,y:0};return this._prevCursorPos=e,i}},{key:"_scrollDiff",get:function(){var e=this.DS.stores.ScrollStore.currentVal,i=this._prevScrollPos?A(e,"-",this._prevScrollPos):{x:0,y:0};return this._prevScrollPos=e,i}}]),r}(),Ue=function(){function r(n){var e=this,i=n.DS,t=n.id,s=n.element,o=n.droppables;h(this,r),a(this,"id",void 0),a(this,"element",void 0),a(this,"_droppables",void 0),a(this,"_rect",void 0),a(this,"_observers",void 0),a(this,"_timeout",void 0),a(this,"_itemsDropped",[]),a(this,"_itemsInside",void 0),a(this,"setReadyClasses",function(l){if(!e.isDestroyed){var c=e.droppables.filter(function(d){return e.DS.SelectedSet.has(d)});!c.length||(c.forEach(function(d){d.classList[l]("".concat(e.Settings.droppableClass)),d.classList[l]("".concat(e.Settings.droppableClass,"-").concat(e.id))}),e.element.classList[l]("".concat(e.Settings.dropZoneReadyClass)))}}),a(this,"handleNoDrop",function(){var l;e.isDestroyed||(e.DS.SelectedSet.forEach(function(c){c.classList.remove(e.Settings.droppedTargetClass),c.classList.remove("".concat(e.Settings.droppedTargetClass,"-").concat(e.id))}),e._itemsDropped=e._itemsDropped.filter(function(c){return!e.DS.SelectedSet.has(c)}),(l=e._itemsDropped)!==null&&l!==void 0&&l.length||e.element.classList.remove("".concat(e.Settings.dropZoneTargetClass)))}),a(this,"handleDrop",function(){var l,c,d;e.isDestroyed||(e._itemsDropped=L(new Set([].concat(L(e._itemsDropped),L((l=e.droppables)===null||l===void 0?void 0:l.filter(function(S){return e.DS.SelectedSet.has(S)}))))),(c=e._itemsDropped)===null||c===void 0||c.forEach(function(S){S.classList.add("".concat(e.Settings.droppedTargetClass)),S.classList.add("".concat(e.Settings.droppedTargetClass,"-").concat(e.id))}),(d=e._itemsDropped)!==null&&d!==void 0&&d.length&&e.element.classList.add("".concat(e.Settings.dropZoneTargetClass)))}),a(this,"handleItemsInsideClasses",function(){var l=!1;e.droppables.forEach(function(c){e.itemsInside.includes(c)?(c.classList.add("".concat(e.Settings.droppedInsideClass)),c.classList.add("".concat(e.Settings.droppedInsideClass,"-").concat(e.id)),l=!0):(c.classList.remove("".concat(e.Settings.droppedInsideClass,"-").concat(e.id)),c.className.includes("".concat(e.Settings.droppedInsideClass,"-"))||c.classList.remove("".concat(e.Settings.droppedInsideClass)))}),l?e.element.classList.add("".concat(e.Settings.dropZoneInsideClass)):e.element.classList.remove("".concat(e.Settings.dropZoneInsideClass))}),a(this,"start",function(l){var c=l.isDragging;!c||e.isDestroyed||e.setReadyClasses("add")}),a(this,"stop",function(l){var c=l.isDragging;!c||e.isDestroyed||(e.setReadyClasses("remove"),e.handleItemsInsideClasses())}),a(this,"toObject",function(){return{id:e.id,element:e.element,droppables:e.droppables,itemsDropped:e.itemsDropped,itemsInside:e.itemsInside}}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.id=t,this.element=s,o&&(this.droppables=N(o)),this.element.classList.add("".concat(this.Settings.dropZoneClass)),this.DS.subscribe("Settings:updated:dropZoneClass",function(l){var c=l.settings;!e.element||(e.element.classList.remove(c["dropZoneClass:pre"]),e.element.classList.add(c.dropZoneClass))}),this._observers=re(this.parentNodes,ne(function(){return e._rect=null},this.Settings.refreshMemoryRate)),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop)}return p(r,[{key:"destroy",value:function(){var e=this;this._observers.cleanup(),this.element.classList.remove("".concat(this.Settings.dropZoneClass)),this.element.classList.remove("".concat(this.Settings.dropZoneTargetClass)),this.element.classList.remove("".concat(this.Settings.dropZoneReadyClass)),this.droppables.forEach(function(i){i.classList.remove("".concat(e.Settings.droppedTargetClass)),i.classList.remove("".concat(e.Settings.droppedTargetClass,"-").concat(e.id)),i.classList.remove("".concat(e.Settings.droppableClass)),i.classList.remove("".concat(e.Settings.droppableClass,"-").concat(e.id))}),this.DS.unsubscribe("Interaction:start",this.start),this.DS.unsubscribe("Interaction:end",this.stop),this.element=null,this.droppables=null,this.id=null,this._itemsDropped=null,this._itemsInside=null,this.isDestroyed=!0}},{key:"rect",get:function(){return this.isDestroyed?null:this._rect?this._rect:this._rect=this.element.getBoundingClientRect()}},{key:"itemsDropped",get:function(){return this.isDestroyed?null:this._itemsDropped}},{key:"itemsInside",get:function(){var e=this;return this.isDestroyed?null:this._itemsInside?this._itemsInside:(this._itemsInside=this.droppables.flatMap(function(i){return k(e.DS.SelectableSet.rects.get(i),e.rect,e.Settings.dropInsideThreshold)?[i]:[]}),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){return e._itemsInside=null},this.Settings.refreshMemoryRate),this._itemsInside)}},{key:"parentNodes",get:function(){return this._parentNodes?this._parentNodes:this._parentNodes=se(this.element)}},{key:"droppables",get:function(){return this._droppables?this._droppables:this.DS.SelectableSet.elements},set:function(e){this._droppables=e}}]),r}(),Xe=p(function r(n){var e=this,i=n.DS;h(this,r),a(this,"_zoneByElement",new Map),a(this,"_zoneById",new Map),a(this,"_zonesByDroppable",new Map),a(this,"_zones",void 0),a(this,"setDropZones",function(t){var s=t.dropZones;!s||(e._zones&&e._zones.forEach(function(o){return o.destroy()}),e._zones=s.map(function(o){return new Ue(u({DS:e.DS},o))}),e._zones.forEach(function(o){e._zoneByElement.set(o.element,o),e._zoneById.set(o.id,o),o.droppables.forEach(function(l){var c=e._zonesByDroppable.get(l);if(!(c!=null&&c.length))return e._zonesByDroppable.set(l,[o]);e._zonesByDroppable.set(l,L(new Set([].concat(L(c),[o]))))})}))}),a(this,"_handleDrop",function(t){e._zones.forEach(function(s){s!==t&&s.handleNoDrop()}),t&&t.handleDrop()}),a(this,"_getZoneByElementsFromPoint",function(t,s){for(var o=s.x,l=s.y,c=0,d=t.length;c<d;c++){var S=e._zoneByElement.get(t[c]);if(S&&k(S.rect,{left:o,right:o,top:l,bottom:l},Math.min(e.Settings.dropTargetThreshold,.5)))return S}}),a(this,"stop",function(t){var s=t.isDragging;if(!!s){var o=e.getTarget();e._handleDrop(o)}}),a(this,"getItemsDroppedById",function(t){var s=e._zoneById.get(t);return s?s.itemsDropped:console.warn("[DragSelect] No zone found (id: ".concat(t,")"))}),a(this,"getItemsInsideById",function(t,s){var o=e._zoneById.get(t);if(!o)return console.warn("[DragSelect] No zone found (id: ".concat(t,")"));var l=o.itemsInside;return s&&o.handleItemsInsideClasses(),l}),a(this,"getTarget",function(t){var s;if(!!((s=e._zones)!==null&&s!==void 0&&s.length)){var o=t?.x||e.DS.stores.PointerStore.currentVal.x,l=t?.y||e.DS.stores.PointerStore.currentVal.y,c=document.elementsFromPoint(o,l);return e._getZoneByElementsFromPoint(c,{x:o,y:l})}}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Settings:updated:dropZones",function(t){var s=t.settings;return e.setDropZones(s)}),this.setDropZones({dropZones:this.DS.stores.SettingsStore.s.dropZones}),this.DS.subscribe("Interaction:end",this.stop)}),qe=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"isInteracting",void 0),a(this,"isDragging",void 0),a(this,"init",function(){return e.DS.publish("Interaction:init:pre",{})}),a(this,"_init",function(){e.stop(),e.Settings.usePointerEvents?e.DS.Area.HTMLNode.addEventListener("pointerdown",e.start,{passive:!1}):e.DS.Area.HTMLNode.addEventListener("mousedown",e.start),e.DS.Area.HTMLNode.addEventListener("touchstart",e.start,{passive:!1}),e.DS.publish("Interaction:init",{})}),a(this,"start",function(t){return e.DS.publish("Interaction:start:pre",{event:t,isDragging:e.isDragging})}),a(this,"_start",function(t){t.type==="touchstart"&&t.preventDefault(),e._canInteract(t)&&(e.isInteracting=!0,e.isDragging=e.isDragEvent(t),e.DS.publish("Interaction:start",{event:t,isDragging:e.isDragging}),e.Settings.usePointerEvents?(document.addEventListener("pointerup",e.reset),document.addEventListener("pointercancel",e.reset)):document.addEventListener("mouseup",e.reset),document.addEventListener("touchend",e.reset))}),a(this,"isDragEvent",function(t){var s=t.target.closest(".".concat(e.Settings.selectableClass));return!e.Settings.draggability||e.DS.stores.KeyStore.isMultiSelectKeyPressed(t)||!s?!1:(e.Settings.immediateDrag&&(e.DS.SelectedSet.size?e.DS.SelectedSet.has(s)||(e.DS.SelectedSet.clear(),e.DS.SelectedSet.add(s)):e.DS.SelectedSet.add(s)),!!e.DS.SelectedSet.has(s))}),a(this,"onClick",function(t){var s=t.event;if(!!e._canInteract(s)&&!(s.detail>0)){var o=e.DS,l=o.stores,c=l.PointerStore,d=l.KeyStore,S=o.SelectableSet,_=o.SelectedSet;c.start(s);var x=s.target;!S.has(x)||(d.isMultiSelectKeyPressed(s)||_.clear(),_.toggle(x),e.reset())}}),a(this,"stop",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.DS.Area.HTMLNode;e.isInteracting=!1,e.isDragging=!1,e.Settings.usePointerEvents?(t.removeEventListener("pointerdown",e.start,{passive:!1}),document.removeEventListener("pointerup",e.reset),document.removeEventListener("pointercancel",e.reset)):(t.removeEventListener("mousedown",e.start),document.removeEventListener("mouseup",e.reset)),t.removeEventListener("touchstart",e.start,{passive:!1}),document.removeEventListener("touchend",e.reset)}),a(this,"update",function(t){var s=t.event,o=t.scroll_directions,l=t.scroll_multiplier;e.isInteracting&&e.DS.publish(["Interaction:update:pre","Interaction:update"],{event:s,scroll_directions:o,scroll_multiplier:l,isDragging:e.isDragging})}),a(this,"reset",function(t){return e.DS.publish("Interaction:end:pre",{event:t,isDragging:e.isDragging})}),a(this,"_reset",function(t){var s=e.isDragging;e.stop(),e.init(),e.DS.publish("Interaction:end",{event:t,isDragging:s})}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Settings:updated:area",function(t){var s=t.settings;e.stop(s["area:pre"]),e.init()}),this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Selectable:click",this.onClick),this.DS.subscribe("Selectable:pointer",function(t){var s=t.event;return e.start(s)}),this.DS.subscribe("Interaction:start:pre",function(t){var s=t.event;return e._start(s)}),this.DS.subscribe("Interaction:init:pre",this._init),this.DS.subscribe("Interaction:end:pre",function(t){var s=t.event;return e._reset(s)}),this.DS.subscribe("Area:scroll",this.update)}return p(r,[{key:"_canInteract",value:function(e){var i=e.clientX===0&&e.clientY===0&&e.detail===0&&e.target;return!(e.button===2||this.isInteracting||e.target&&!this.DS.SelectorArea.isInside(e.target)||!i&&!this.DS.SelectorArea.isClicked(e))}}]),r}(),Je=p(function r(n){var e=this,i=n.DS;h(this,r),a(this,"subscribers",{}),a(this,"subscribe",function(t,s){return Array.isArray(e.subscribers[t])||(e.subscribers[t]=[]),e.subscribers[t].push(s),e.subscribers[t].length-1}),a(this,"unsubscribe",function(t,s,o){o>=0?e.subscribers[t].splice(o,1):s&&(e.subscribers[t]=e.subscribers[t].filter(function(l){return l!==s}))}),a(this,"publish",function(t,s){Array.isArray(t)?t.forEach(function(o){return e._publish(o,s)}):e._publish(t,s)}),a(this,"_publish",function(t,s){var o=e.subscribers[t];!Array.isArray(o)||(t.includes(":pre")?e._handlePrePublish(o,s):e._handlePublish(o,s))}),a(this,"_handlePublish",function(t,s){for(var o=0,l=t.length;o<l;o++){if(e.DS.stopped)return;t[o](s)}}),a(this,"_handlePrePublish",function(t,s){for(var o=t.length;o--;){if(e.DS.stopped)return;t[o](s)}}),this.DS=i}),Qe=function(r){J(e,r);var n=F(e);function e(i){var t,s=i.DS;return h(this,e),t=n.call(this),a(I(t),"_rects",void 0),a(I(t),"_timeout",void 0),a(I(t),"init",function(){return N(t.Settings.selectables).forEach(function(o){return t.add(o)})}),a(I(t),"clear",function(){return t.forEach(function(o){return t.delete(o)})}),a(I(t),"_onClick",function(o){return t.DS.publish(["Selectable:click:pre","Selectable:click"],{event:o})}),a(I(t),"_onPointer",function(o){return t.DS.publish(["Selectable:pointer:pre","Selectable:pointer"],{event:o})}),a(I(t),"addAll",function(o){return o.forEach(function(l){return t.add(l)})}),a(I(t),"deleteAll",function(o){return o.forEach(function(l){return t.delete(l)})}),a(I(t),"getRect",function(o){return t._rects?t.rects.get(o):o.getBoundingClientRect()}),t.DS=s,t.Settings=s.stores.SettingsStore.s,t.DS.subscribe("Interaction:init",t.init),t.DS.PubSub.subscribe("Settings:updated:selectables",function(){t.clear(),t.init()}),t.DS.subscribe("Settings:updated:selectableClass",function(o){var l=o.settings;t.forEach(function(c){c.classList.remove(l["selectableClass:pre"]),c.classList.add(l.selectableClass)})}),t}return p(e,[{key:"add",value:function(t){if(E(P(e.prototype),"has",this).call(this,t))return this;var s={items:this.elements,item:t};return this.DS.publish("Selectable:added:pre",s),t.classList.add(this.Settings.selectableClass),t.addEventListener("click",this._onClick),this.Settings.usePointerEvents?t.addEventListener("pointerdown",this._onPointer,{passive:!1}):t.addEventListener("mousedown",this._onPointer),t.addEventListener("touchstart",this._onPointer,{passive:!1}),this.Settings.draggability&&!this.Settings.useTransform&&le({computedStyle:window.getComputedStyle(t),node:t}),E(P(e.prototype),"add",this).call(this,t),this.DS.publish("Selectable:added",s),this}},{key:"delete",value:function(t){if(!E(P(e.prototype),"has",this).call(this,t))return!0;var s={items:this.elements,item:t};return this.DS.publish("Selectable:removed:pre",s),t.classList.remove(this.Settings.selectableClass),t.classList.remove(this.Settings.hoverClass),t.removeEventListener("click",this._onClick),this.Settings.usePointerEvents?t.removeEventListener("pointerdown",this._onPointer,{passive:!1}):t.removeEventListener("mousedown",this._onPointer),t.removeEventListener("touchstart",this._onPointer,{passive:!1}),E(P(e.prototype),"delete",this).call(this,t),this.DS.publish("Selectable:removed",s),!0}},{key:"elements",get:function(){return Array.from(this.values())}},{key:"rects",get:function(){var t=this;return this._rects?this._rects:(this._rects=new Map,this.forEach(function(s){return t._rects.set(s,s.getBoundingClientRect())}),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){return t._rects=null},this.Settings.refreshMemoryRate),this._rects)}}]),e}(H(Set)),Fe=function(r){J(e,r);var n=F(e);function e(i){var t,s=i.DS;return h(this,e),t=n.call(this),a(I(t),"clear",function(){return t.forEach(function(o){return t.delete(o)})}),a(I(t),"addAll",function(o){return o.forEach(function(l){return t.add(l)})}),a(I(t),"deleteAll",function(o){return o.forEach(function(l){return t.delete(l)})}),t.DS=s,t}return p(e,[{key:"add",value:function(t){if(E(P(e.prototype),"has",this).call(this,t))return this;var s={items:this.elements,item:t};return this.DS.publish("Selected:added:pre",s),E(P(e.prototype),"add",this).call(this,t),t.classList.add(this.DS.stores.SettingsStore.s.selectedClass),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)+1),this.DS.publish("Selected:added",s),this}},{key:"delete",value:function(t){if(!E(P(e.prototype),"has",this).call(this,t))return!0;var s={items:this.elements,item:t};this.DS.publish("Selected:removed:pre",s);var o=E(P(e.prototype),"delete",this).call(this,t);return t.classList.remove(this.DS.stores.SettingsStore.s.selectedClass),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)-1),this.DS.publish("Selected:removed",s),o}},{key:"toggle",value:function(t){return this.has(t)?this.delete(t):this.add(t),t}},{key:"elements",get:function(){return Array.from(this.values())}}]),e}(H(Set)),et=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_prevSelectedSet",void 0),a(this,"start",function(t){var s=t.event,o=t.isDragging;o||(e._storePrevious(s),e._handleInsideSelection(!0,s))}),a(this,"update",function(t){var s=t.isDragging;s||e.DS.continue||e._handleInsideSelection()}),a(this,"_handleInsideSelection",function(t,s){var o=e.DS,l=o.SelectableSet,c=o.SelectorArea,d=o.Selector,S=e.DS.stores.KeyStore.isMultiSelectKeyPressed(s)&&e.Settings.multiSelectToggling,_=e.Settings.selectionThreshold,x=l.rects,C=d.rect,w=new Map,D=new Map,T=Te(x),K;try{for(T.s();!(K=T.n()).done;){var z=W(K.value,2),Z=z[0],$=z[1];!c.isInside(Z,$)||(k($,C,_)?w.set(Z,$):D.set(Z,$))}}catch(X){T.e(X)}finally{T.f()}if(!e.DS.continue){var he=e.filterSelected({select:w,unselect:D,selectorRect:C}),at=he.select,lt=he.unselect;at.forEach(function(X,q){return Be({element:q,force:t,multiSelectionToggle:S,SelectedSet:e.DS.SelectedSet,hoverClassName:e.Settings.hoverClass})}),lt.forEach(function(X,q){return He({element:q,force:t,SelectedSet:e.DS.SelectedSet,hoverClassName:e.Settings.hoverClass,PrevSelectedSet:e._prevSelectedSet})})}}),a(this,"filterSelected",function(t){var s=t.select,o=t.unselect;return t.selectorRect,{select:s,unselect:o}}),this.DS=i,this.Settings=this.DS.stores.SettingsStore.s,this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return p(r,[{key:"_storePrevious",value:function(e){var i=this.DS,t=i.stores.KeyStore,s=i.SelectedSet;t.isMultiSelectKeyPressed(e)?this._prevSelectedSet=new Set(s):this._prevSelectedSet=new Set}}]),r}(),tt=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_rect",void 0),a(this,"attachSelector",function(){var t,s;e.HTMLNode&&(t=e.DS.SelectorArea)!==null&&t!==void 0&&t.HTMLNode&&e.DS.SelectorArea.HTMLNode.removeChild(e.HTMLNode),e.HTMLNode=e.DS.stores.SettingsStore.s.selector||we(e.DS.stores.SettingsStore.s.customStyles),e.HTMLNode.classList.add(e.DS.stores.SettingsStore.s.selectorClass),e.HTMLNode&&(s=e.DS.SelectorArea)!==null&&s!==void 0&&s.HTMLNode&&e.DS.SelectorArea.HTMLNode.appendChild(e.HTMLNode)}),a(this,"start",function(t){var s=t.isDragging;if(!s){var o=e.DS.stores.PointerStore,l=o.initialValArea;ue(e.HTMLNode,te(l,1)),e.HTMLNode.style.display="block",e._rect=null}}),a(this,"stop",function(){e.HTMLNode.style.width="0",e.HTMLNode.style.height="0",e.HTMLNode.style.display="none"}),a(this,"update",function(t){var s=t.isDragging;if(!(s||e.DS.continue)){var o=e.DS.stores,l=o.ScrollStore,c=o.PointerStore,d=ke({scrollAmount:l.scrollAmount,initialPointerPos:c.initialValArea,pointerPos:c.currentValArea});ue(e.HTMLNode,d),e._rect=null}}),this.DS=i,this.DS.subscribe("Settings:updated:selectorClass",function(t){var s=t.settings;e.HTMLNode.classList.remove(s["selectorClass:pre"]),e.HTMLNode.classList.add(s.selectorClass)}),this.DS.subscribe("Settings:updated:selector",this.attachSelector),this.DS.subscribe("Settings:updated:customStyles",this.attachSelector),this.attachSelector(),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return p(r,[{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),r}(),rt=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_scrollInterval",void 0),a(this,"_rect",void 0),a(this,"currentEdges",[]),a(this,"start",function(){e.applyElements("append"),e.updatePos()}),a(this,"applyElements",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"append",s=document.body?"body":"documentElement",o="".concat(t,"Child");e.HTMLNode[o](e.DS.Selector.HTMLNode),document[s][o](e.HTMLNode)}),a(this,"updatePos",function(){e._rect=null;var t=e.DS.Area.rect,s=e.DS.Area.computedBorder,o=e.HTMLNode.style,l="".concat(t.top+s.top,"px"),c="".concat(t.left+s.left,"px"),d="".concat(t.width,"px"),S="".concat(t.height,"px");o.top!==l&&(o.top=l),o.left!==c&&(o.left=c),o.width!==d&&(o.width=d),o.height!==S&&(o.height=S)}),a(this,"stop",function(t){e.stopAutoScroll(),t&&e.applyElements("remove")}),a(this,"startAutoScroll",function(){e.currentEdges=[],e._scrollInterval=setInterval(function(){return e.handleAutoScroll()},16)}),a(this,"handleAutoScroll",function(){if(!e.DS.continue){var t=e.DS,s=t.stores.PointerStore,o=t.Area;e.currentEdges=oe({elementRect:te(s.currentVal),containerRect:e.rect,tolerance:e.DS.stores.SettingsStore.s.overflowTolerance}),e.currentEdges.length&&o.scroll(e.currentEdges,e.DS.stores.SettingsStore.s.autoScrollSpeed)}}),a(this,"stopAutoScroll",function(){e.currentEdges=[],clearInterval(e._scrollInterval)}),a(this,"isInside",function(t,s){return e.DS.Area.HTMLNode.contains(t)&&e.DS.stores.ScrollStore.canScroll?!0:k(e.rect,s||t.getBoundingClientRect())}),this.DS=i,this.HTMLNode=Ce(),this.DS.subscribe("Settings:updated:selectorAreaClass",function(t){var s=t.settings;e.HTMLNode.classList.remove(s["selectorAreaClass:pre"]),e.HTMLNode.classList.add(s.selectorAreaClass)}),this.HTMLNode.classList.add(this.DS.stores.SettingsStore.s.selectorAreaClass),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:init",this.start),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",function(){e.updatePos(),e.stopAutoScroll()})}return p(r,[{key:"isClicked",value:function(e){var i=this.DS.stores.PointerStore,t=e?i.getPointerPosition(e):i.initialVal;return k({left:t.x,top:t.y,right:t.x,bottom:t.y},this.rect)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),r}(),nt=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_currentValues",new Set),a(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),a(this,"init",function(){document.addEventListener("keydown",e.keydown),document.addEventListener("keyup",e.keyup),window.addEventListener("blur",e.reset)}),a(this,"keydown",function(t){var s=t.key.toLowerCase();e.DS.publish("KeyStore:down:pre",{event:t,key:s}),e._currentValues.add(s),e.DS.publish("KeyStore:down",{event:t,key:s})}),a(this,"keyup",function(t){var s=t.key.toLowerCase();e.DS.publish("KeyStore:up:pre",{event:t,key:s}),e._currentValues.delete(s),e.DS.publish("KeyStore:up",{event:t,key:s})}),a(this,"stop",function(){document.removeEventListener("keydown",e.keydown),document.removeEventListener("keyup",e.reset),window.removeEventListener("blur",e.reset),e.reset()}),a(this,"reset",function(){return e._currentValues.clear()}),this.DS=i,this.DS.subscribe("Interaction:init",this.init)}return p(r,[{key:"isMultiSelectKeyPressed",value:function(e){var i=this;if(this.DS.stores.SettingsStore.s.multiSelectMode)return!0;var t=this.DS.stores.SettingsStore.s.multiSelectKeys.map(function(s){return s.toLocaleLowerCase()});return!!(this.currentValues.some(function(s){return t.includes(s.toLocaleLowerCase())})||e&&t.some(function(s){return e[i._keyMapping[s]]}))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),r}(),st=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_isMouseInteraction",!1),a(this,"_initialValArea",void 0),a(this,"_currentValArea",void 0),a(this,"_lastValArea",void 0),a(this,"_initialVal",void 0),a(this,"_currentVal",void 0),a(this,"_lastVal",void 0),a(this,"_lastTouch",void 0),a(this,"init",function(){e.Settings.usePointerEvents?document.addEventListener("pointermove",e.update,{passive:!1}):document.addEventListener("mousemove",e.update),document.addEventListener("touchmove",e.update,{passive:!1})}),a(this,"getPointerPosition",function(t){return Me({event:e._normalizedEvent(t)})}),a(this,"update",function(t){!t||(e.DS.publish("PointerStore:updated:pre",{event:t}),e.currentVal=e.getPointerPosition(t),e._isMouseInteraction&&e.DS.publish("PointerStore:updated",{event:t}))}),a(this,"stop",function(){e.Settings.usePointerEvents?document.removeEventListener("pointermove",e.update,{passive:!1}):document.removeEventListener("mousemove",e.update),document.removeEventListener("touchmove",e.update,{passive:!1}),setTimeout(function(){return e._isMouseInteraction=!1},100)}),a(this,"reset",function(t){!t||(e.currentVal=e.lastVal=e.getPointerPosition(t),e.stop(),e.init())}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",function(t){var s=t.event;return e.start(s)}),this.DS.subscribe("Interaction:end",function(t){var s=t.event;return e.reset(s)})}return p(r,[{key:"start",value:function(e){!e||(this._isMouseInteraction=!0,this.currentVal=this.initialVal=this.getPointerPosition(e))}},{key:"_normalizedEvent",value:function(e){return"touches"in e&&e.type!=="touchend"&&(this._lastTouch=e),"touches"in e?this._lastTouch.touches[0]:e}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(e){this._initialVal=e,this._initialValArea=e&&A(e,"-",A(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(e){this._currentVal=e,this._currentValArea=e&&A(e,"-",A(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(e){this._lastVal=e,this._lastValArea=e&&A(e,"-",A(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}}]),r}(),it=function(){function r(n){var e=this,i=n.DS;h(this,r),a(this,"_initialVal",void 0),a(this,"_currentVal",void 0),a(this,"_canScroll",void 0),a(this,"init",function(){return e.DS.stores.SettingsStore.s.area.addEventListener("scroll",e.update)}),a(this,"start",function(){e._currentVal=e._initialVal=j(e.DS.stores.SettingsStore.s.area),e.DS.stores.SettingsStore.s.area.addEventListener("scroll",e.update)}),a(this,"update",function(){return e._currentVal=j(e.DS.stores.SettingsStore.s.area)}),a(this,"stop",function(){e.DS.stores.SettingsStore.s.area.removeEventListener("scroll",e.update),e._initialVal={x:0,y:0},e._canScroll=null}),a(this,"reset",function(){e.stop(),e.start()}),this.DS=i,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",function(){return e.start()}),this.DS.subscribe("Interaction:end",function(){return e.reset()})}return p(r,[{key:"canScroll",get:function(){return typeof this._canScroll=="boolean"?this._canScroll:this._canScroll=xe(this.DS.stores.SettingsStore.s.area)}},{key:"scrollAmount",get:function(){var e=A(this.currentVal,"-",this.initialVal),i=Le(this.DS.stores.SettingsStore.s.zoom),t=A(A(e,"*",i),"-",e);return{x:e.x+t.x,y:e.y+t.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal||(this._currentVal=j(this.DS.stores.SettingsStore.s.area)),this._currentVal}}]),r}(),ot=p(function r(n){var e=this,i=n.DS,t=n.settings;h(this,r),a(this,"_settings",{}),a(this,"s",{}),a(this,"update",function(s){var o=s.settings,l=s.init;return e.DS.publish("Settings:updated:pre",u({settings:o},l?{init:l}:{}))}),a(this,"_update",function(s){for(var o=s.settings,l=s.init,c=je(o,l),d=function(){var C,w=W(_[S],2),D=w[0],T=w[1];D in e._settings||Object.defineProperty(e.s,D,{get:function(){return e._settings[D]},set:function(Z){return e.update({settings:a({},D,Z)})}}),e._settings["".concat(D,":pre")]=e._settings[D],e._settings[D]=T;var K={settings:(C={},a(C,D,e._settings[D]),a(C,"".concat(D,":pre"),e._settings["".concat(D,":pre")]),C)};e.DS.publish("Settings:updated",K),e.DS.publish("Settings:updated:".concat(D),K)},S=0,_=Object.entries(c);S<_.length;S++)d()}),this.DS=i,this.DS.subscribe("Settings:updated:pre",this._update),this.update({settings:t,init:!0})}),de=function(){function r(n){var e=this;h(this,r),a(this,"continue",!1),a(this,"start",function(){e.stopped=!1,e.Interaction.init()}),a(this,"break",function(){return e.continue=!0}),a(this,"setSettings",function(i){return e.stores.SettingsStore.update({settings:i})}),a(this,"getSelection",function(){return e.SelectedSet.elements}),a(this,"getSelectables",function(){return e.SelectableSet.elements}),a(this,"getInitialCursorPosition",function(){return e.stores.PointerStore.initialVal}),a(this,"getCurrentCursorPosition",function(){return e.stores.PointerStore.currentVal}),a(this,"getPreviousCursorPosition",function(){return e.stores.PointerStore.lastVal}),a(this,"getInitialCursorPositionArea",function(){return e.stores.PointerStore.initialValArea}),a(this,"getCurrentCursorPositionArea",function(){return e.stores.PointerStore.currentValArea}),a(this,"getPreviousCursorPositionArea",function(){return e.stores.PointerStore.lastValArea}),a(this,"isMultiSelect",function(i){return e.stores.KeyStore.isMultiSelectKeyPressed(i)}),a(this,"isDragging",function(){return e.Interaction.isDragging}),a(this,"getZoneByCoordinates",function(i){var t;return(t=e.DropZones.getTarget(i))===null||t===void 0?void 0:t.toObject()}),a(this,"getItemsDroppedByZoneId",function(i){return e.DropZones.getItemsDroppedById(i)}),a(this,"getItemsInsideByZoneId",function(i,t){return e.DropZones.getItemsInsideById(i,t)}),this.PubSub=new Je({DS:this}),this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this.stores={},this.stores.SettingsStore=new ot({DS:this,settings:n}),this.stores.PointerStore=new st({DS:this}),this.stores.ScrollStore=new it({DS:this}),this.stores.KeyStore=new nt({DS:this}),this.Area=new Ge({DS:this}),this.Selector=new tt({DS:this}),this.SelectorArea=new rt({DS:this}),this.SelectableSet=new Qe({DS:this}),this.SelectedSet=new Fe({DS:this}),this.Selection=new et({DS:this}),this.Drag=new Ye({DS:this}),this.DropZones=new Xe({DS:this}),this.Interaction=new qe({DS:this}),We({subscribe:this.subscribe,publish:this.publish,SelectedSet:this.SelectedSet,Interaction:this.Interaction,DropZones:this.DropZones}),this.subscribe("Interaction:end",function(){return e.continue=!1}),this.start()}return p(r,[{key:"stop",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Area.stop(),this.Drag.stop(),this.Selector.stop(),this.SelectorArea.stop(e),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),e&&this.SelectableSet.clear(),i&&this.SelectedSet.clear(),this.stopped=!0}},{key:"addSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.SelectedSet.addAll(N(e)),t||this.addSelectables(e),i&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.SelectedSet.deleteAll(N(e)),t&&this.removeSelectables(e),i&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(e){var i=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return N(e).forEach(function(o){return i.SelectedSet.has(o)?i.removeSelection(e,t,s):i.addSelection(e,t,s)}),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.clearSelection(),this.addSelection(e,i,t),this.getSelection()}},{key:"clearSelection",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.SelectedSet.clear(),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(e,i,t){var s=N(e);return this.SelectableSet.addAll(s),i&&this.SelectedSet.addAll(s),t&&this.PubSub.publish("callback",{items:this.getSelection()}),e}},{key:"setSelectables",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return console.warn('[DragSelect] DEPRECATION ".setSelectables" is deprecated and will be removed soon. Please use "ds.setSettings({ selectables: << new dom elements >> })" instead (see docs)'),this.removeSelectables(e,i),this.addSelectables(e,t)}},{key:"removeSelectables",value:function(e,i,t){return this.SelectableSet.deleteAll(N(e)),i&&this.removeSelection(e),t&&this.PubSub.publish("callback",{items:this.getSelection()}),e}}]),r}();return de.isCollision=k,de})})(pe);const ft=pe.exports,ge=g=>{const m=g.createReader();return new Promise(b=>{const y=[],u=()=>{};function h(){m.readEntries(v=>{v.length?(y.push(Promise.all(v.map(p=>p.isDirectory?ge(p):Promise.resolve(p)))),h()):b(Promise.all(y))},u)}h()})},ve=(g,m)=>({fileObject:g,fullPath:m?m.fullPath:"",lastModified:g.lastModified,lastModifiedDate:g.lastModifiedDate,name:g.name,size:g.size,type:g.type,webkitRelativePath:g.webkitRelativePath}),fe=g=>new Promise(m=>{g.file(b=>{m(ve(b,g))})}),Se=(g,m)=>Promise.all(g).then(b=>(b.forEach(y=>{m.push(y)}),m)),ut=g=>{const m=[],b=[],y=[];if([].slice.call(g.items).forEach(u=>{let h;typeof u.webkitGetAsEntry=="function"?h="webkitGetAsEntry":h="getAsEntry";const v=u[h]();v?v.isDirectory?b.push(ge(v)):y.push(fe(v)):m.push(u)}),b.length){const u=h=>h.reduce((v,p)=>v.concat(Array.isArray(p)?u(p):p),[]);return Promise.all(b).then(h=>(u(h).forEach(p=>{y.push(fe(p))}),Se(y,m)))}else if(y.length)return Se(y,m);return Promise.resolve(m)},dt=g=>{const m=g.dataTransfer;if(m&&m.items)return ut(m).then(v=>Promise.resolve(v));const b=[],y=m&&m.files,u=g.target&&g.target.files,h=y||u||[];for(let v=0;v<h.length;v++)b.push(ve(h[v]));return Promise.resolve(b)};async function St(g){let m=await dt(g),b={};for(let y of m){let u=y.fullPath.split("/").filter(h=>h!="");u.reduce((h,v,p)=>(p!=u.length-1?h[v]==null&&(h[v]={}):h[v]=y.fileObject,h[v]),b)}return b}export{ft as D,St as p};
