(function(){"use strict";var E=function(e){return function(t,r,i){return e(t,r,i)*i}},d=function(e,t){if(e)throw Error("Invalid sort config: "+t)},g=function(e){var t=e||{},r=t.asc,i=t.desc,n=r?1:-1,u=r||i;d(!u,"Expected `asc` or `desc` property"),d(r&&i,"Ambiguous object with `asc` and `desc` config properties");var a=e.comparer&&E(e.comparer);return{order:n,sortBy:u,comparer:a}},N=function(e){return function t(r,i,n,u,a,s,o){var f,l;if(typeof r=="string")f=s[r],l=o[r];else if(typeof r=="function")f=r(s),l=r(o);else{var c=g(r);return t(c.sortBy,i,n,c.order,c.comparer||e,s,o)}var I=a(f,l,u);return(I===0||f==null&&l==null)&&i.length>n?t(i[n],i,n+1,u,a,s,o):I}};function m(e,t,r){if(e===void 0||e===!0)return function(u,a){return t(u,a,r)};if(typeof e=="string")return d(e.includes("."),"String syntax not allowed for nested properties."),function(u,a){return t(u[e],a[e],r)};if(typeof e=="function")return function(u,a){return t(e(u),e(a),r)};if(Array.isArray(e)){var i=N(t);return function(u,a){return i(e[0],e,1,r,t,u,a)}}var n=g(e);return m(n.sortBy,n.comparer||t,n.order)}var v=function(e,t,r,i){var n;return Array.isArray(t)?(Array.isArray(r)&&r.length<2&&(n=r,r=n[0]),t.sort(m(r,i,e))):t};function A(e){var t=E(e.comparer);return function(r){var i=Array.isArray(r)&&!e.inPlaceSorting?r.slice():r;return{asc:function(n){return v(1,i,n,t)},desc:function(n){return v(-1,i,n,t)},by:function(n){return v(1,i,n,t)}}}}var _=function(e,t,r){return e==null?r:t==null?-r:typeof e!=typeof t?typeof e<typeof t?-1:1:e<t?-1:e>t?1:0},S=A({comparer:_});A({comparer:_,inPlaceSorting:!0});let p=Object.freeze({NONE:0,NAME:1,SIZE:2,DATE_CREATED:3,DATE_MODIFIED:4}),y=Object.freeze({ASCENDING:0,DESCENDING:1}),D={};onmessage=async({data:e})=>{let{type:t,hash:r,id:i,items:n,sort_option:u,sort_order:a}=e;if(t!="sort")return;if(u==p.NONE){postMessage({id:i,sorted_items:n,type:"sorted"});return}if(D[r]!=null){postMessage({id:i,sorted_items:D[r],type:"sorted"});return}console.log("sorting",r);for(let c of n)c.type=="folder"&&(c.size=0);let s=a==y.ASCENDING?"asc":"desc",o="name";switch(u){case p.NAME:o="name";break;case p.SIZE:o="size";break;case p.DATE_CREATED:o="date_created";break;case p.DATE_MODIFIED:o="date_modified";break}let f={};f[s]=c=>o=="name"?c[o].toLowerCase():c[o];let l=S(n).by([f]);postMessage({id:i,sorted_items:l,type:"sorted"})}})();
