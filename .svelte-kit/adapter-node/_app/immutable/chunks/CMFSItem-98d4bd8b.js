import{a as p,w as r,b as c,d as x}from"./store-3e4ea696.js";import{r as m,f,s as w,j as v,g as _,w as b}from"./system-eda41220.js";import{c as D}from"./utils-a62a4de9.js";import{g as d}from"./index-ff400fad.js";import{d as u,g as C,e as R,f as k,p as F,h}from"./fs-8c49ae47.js";import g from"short-uuid";import A from"file-saver";import"./index-2945f287.js";import"idb-keyval";import"./finder-762cc408.js";import"buffer";import"./admin-04ad1b95.js";let K=({type:y,originator:e})=>({required_width:180+20,required_height:27*11+20,menu:[[...e.item.parent!=m?[{name:"Open",action:()=>{e.open(e.item.id)},font:"bold"},{name:"Explore"},{name:"Search...",disabled:e.type=="file"}]:[],...e.item.parent!=m&&f[e.item.ext]!=null&&f[e.item.ext].length>=2?[{name:"Open With",items:f[e.item.ext].map(t=>({name:t.name,icon:t.icon,action:()=>p.set({path:t.path,fs_item:e.item})}))}]:[],...w.includes(e.item.ext)?[{name:"Set as Desktop Wallpaper",action:()=>{let t=g.generate();u(e.item.id,b,t),r.set(t)}}]:[]],[...v.includes(e.item.ext)&&e.item.parent!=m?[{name:"Extract here...",icon:"/images/xp/icons/RAR.png",action:()=>{p.set({path:"./programs/winrar.svelte",fs_item:e.item})}}]:[],...["file","folder"].includes(e.item.type)&&e.item.parent!=m?[{name:"Add to archive...",icon:"/images/xp/icons/RAR.png",action:()=>{p.set({path:"./programs/zip.svelte",fs_item:e.item})}}]:[]],[...e.item.parent!=m?[{name:"Send To",items:[...e.item.type=="file"&&e.item.storage_type!="fake"?[{name:"Local Computer (Download)",icon:"/images/xp/icons/CopyingConflict.png",action:async()=>{let t=await C(e.item.id),n=new File([t],e.item.name,{type:D(e.item.name)});A.saveAs(n)}}]:[],{name:"Compressed (Zipped) Folder",icon:"/images/xp/icons/Zipfolder.png",action:()=>{p.set({path:"./programs/zip.svelte",fs_item:e.item})}},{name:"Desktop (create shortcut)",icon:"/images/xp/icons/Desktop.png"},{name:"Mail Recipient",icon:"/images/xp/icons/Email.png"},{name:"Floppy (A:)",icon:"/images/xp/icons/FloppyDisk.png"}]}]:[]],[..._.includes(e.item.id)?[]:[{name:"Cut",disabled:d(c).length==0,action:()=>{R()}}],...e.item.type=="drive"||e.item.type=="removable_storage"?[]:[{name:"Copy",disabled:d(c).length==0,action:()=>{k()}}],...e.item.type!="file"&&e.item.parent!=m?[{name:"Paste",disabled:d(x).length==0,action:()=>{F(e.item.id)}}]:[]],[..._.includes(e.item.id)?[]:[{name:"Delete",action:()=>{let t=[...d(c)];console.log(t);let n=()=>{if(e.item.parent==m)for(let s of t)h(s);else for(let s of t)u(s,m,null),h(s)},l=e.item.name.length>70?e.item.name.slice(0,70)+"...":e.item.name,i="",a="";t.length==1?a="":t.length==2?a=" and 1 other item":t.length>2&&(a=` and ${t.length-1} other items`),e.item.parent==m?i=`Do you want to permanently delete ${l}${a}? This action can't be undone?`:i=`Do you want to move ${l}${a} to the Recycle Bin?`;let o=e.item.parent==m?"/images/xp/icons/DeleteConfirmation.png":"/images/xp/icons/RecycleBinempty.png";$({node_ref:e.my_computer_instance?.window.node_ref||document.body,title:"Confirm Delete File",icon:o,message:i,yes_action:n,no_action:()=>{}})}}],..._.includes(e.item.id)||e.item.parent==m?[]:[{name:"Rename",action:()=>{c.set([e.item.id]),e.rename()}}]],[{name:"Properties",action:()=>{e.item.type=="drive"||e.item.type=="removable_storage"?p.set({path:"./programs/disk_properties.svelte",fs_item:e.item}):p.set({path:"./programs/properties.svelte",fs_item:e.item})}}]]});async function $({node_ref:y,title:e,message:t,icon:n,yes_action:l,no_action:i}){const a=(await import("./Dialog-20b8e919.js")).default;let o=[{name:"OK",action:()=>{l(),s.destroy()},focus:!0},{name:"Cancel",action:()=>{i(),s.destroy()}}],s=new a({target:y,props:{icon:n,title:e,message:t,buttons:o}});s.self=s}export{K as make};
