import{c as W,a as z,v as r,j as N,h as P,e as x}from"../../../../_app/immutable/chunks/index-ff400fad.js";import{W as D}from"../../../../_app/immutable/chunks/Window-e98aeb2f.js";import{B as f}from"../../../../_app/immutable/chunks/Button-c9221fbd.js";import{h as L,r as q,a as h}from"../../../../_app/immutable/chunks/store-3e4ea696.js";import{d as M,f as B}from"../../../../_app/immutable/chunks/system-eda41220.js";import{n as X}from"../../../../_app/immutable/chunks/fs-8c49ae47.js";import"../../../../_app/immutable/chunks/TitleBar-7840ae1a.js";import"lodash";import"idb-keyval";/* empty css                                                                             */import"../../../../_app/immutable/chunks/index-2945f287.js";import"../../../../_app/immutable/chunks/utils-a62a4de9.js";import"short-uuid";import"../../../../_app/immutable/chunks/finder-762cc408.js";import"buffer";import"../../../../_app/immutable/chunks/admin-04ad1b95.js";const ie=W((o,i,t,A)=>{let _,b;b=z(L,e=>_=e);let{id:m}=i,{window:n}=i,{self:d}=i,{parentNode:y}=i,{exec_path:w}=i,u="",s,l,c,g=!1,k;async function a(){q.update(e=>e.filter(T=>T!=d)),d.$destroy()}let{options:v={title:"Installer",min_width:500,min_height:400,width:500,height:400,icon:"/images/xp/icons/Programs.png",resizable:!1,maximize_btn_disabled:!0,id:m,exec_path:w}}=i;async function F(){c=null,s.disabled=!0,s.title="Fetching",fetch("/api/webapp_info",{method:"GET",headers:{webapp_url:u}}).then(e=>e.json()).then(e=>{console.log(e),l=e.webapp,s.title=" Fetch ",s.disabled=!1,l==null&&(c={message:"The webapp you requested has the X-Frame-Options header value set, which prevents win32.run from loading it."})})}async function I(){k=await X({basename:l.name,ext:".exe",executable:!0,icon:l.icon,webapp:{name:l.name,icon:l.icon,url:l.url}},M),g=!0}async function S(){let e=_[k];e.type=="file"?e.executable?h.set({path:e.url,webapp:e.webapp}):B[e.ext]!=null?h.set({path:B[e.ext][0].path,fs_item:e}):h.set({path:"./programs/notepad.svelte",fs_item:e}):h.set({path:"./programs/my_computer.svelte",fs_item:e}),a()}i.id===void 0&&t.id&&m!==void 0&&t.id(m),i.window===void 0&&t.window&&n!==void 0&&t.window(n),i.self===void 0&&t.self&&d!==void 0&&t.self(d),i.parentNode===void 0&&t.parentNode&&y!==void 0&&t.parentNode(y),i.exec_path===void 0&&t.exec_path&&w!==void 0&&t.exec_path(w),i.destroy===void 0&&t.destroy&&a!==void 0&&t.destroy(a),i.options===void 0&&t.options&&v!==void 0&&t.options(v);let p,j;do p=!0,j=`${r(D,"Window").$$render(o,{options:v,on_click_close:a,this:n},{this:e=>{n=e,p=!1}},{content:()=>`<div slot="content" class="absolute inset-1 bg-xp-yellow-light">${g?`<div class="absolute inset-0 flex flex-col p-2 text-[14px] text-slate-900 font-Trebuchet justify-between"><div class="grow flex flex-col items-center justify-center overflow-hidden"><svg class="w-16 h-16 fill-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"></path></svg>
                <p class="text-xl font-bold mt-2">Installed Successfully</p></div>
            <div class="flex flex-row shrink-0 grow-0 justify-end">${r(f,"Button").$$render(o,{on_click:S,style:"margin-right:10px;",title:"Launch >"},{},{})}</div></div>`:`<div class="absolute inset-0 flex flex-col p-2 text-[14px] text-slate-900 font-Trebuchet justify-between"><div class="flex-col flex grow-0 overflow-hidden"><p>The Installer will help you add webapps into Windows XP. Start by entering the web url.</p>
                <p class="my-2">For developers who want their existing webapps to interact with Windows filesystem, please see <a class="text-blue-600 cursor-pointer">this guide</a>. It&#39;s simple, just adding a few lines of code to your existing webapps to pick, read &amp; and write files</p>
                <div class="mt-2 flex flex-row"><input placeholder="webapp url" class="grow p-1 text-slate-800 mr-2 text-sm"${N("value",u,0)}>
                    ${r(f,"Button").$$render(o,{title:" Fetch ",disabled:u.trim()=="",on_click:F,this:s},{this:e=>{s=e,p=!1}},{})}</div>
                ${l?`<div class="flex flex-row p-2 overflow-hidden my-2"><div class="grow-0 shrink-0 bg-cover bg-no-repeat w-12 h-12 m-1"${P({"background-image":`url(${l.icon})`})}></div>
                    <div class=""><p class="font-bold text-base">${x(l.name)}</p>
                        <p>${x(l.desc)}</p></div></div>`:""}
                ${c?`<p class="p-2 text-red-400">${x(c.message)}</p>`:""}</div>
            <div class="flex flex-row shrink-0 grow-0 justify-end">${r(f,"Button").$$render(o,{on_click:I,style:"margin-right:10px;",title:"Install >",disabled:l==null},{},{})}
                ${r(f,"Button").$$render(o,{on_click:a,title:"Cancel"},{},{})}</div></div>`}</div>`})}


`;while(!p);return b(),j});export{ie as default};
